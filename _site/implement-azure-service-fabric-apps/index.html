<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Design and Implement Azure Service Fabric apps" /><meta name="author" content="Wolfgang Ofner" /><meta property="og:locale" content="en" /><meta name="description" content="Azure Service Fabric is a platform that makes it easy to package, deploy, and manage distributed solutions at scale. It provides an easy programming model." /><meta property="og:description" content="Azure Service Fabric is a platform that makes it easy to package, deploy, and manage distributed solutions at scale. It provides an easy programming model." /><link rel="canonical" href="/implement-azure-service-fabric-apps/" /><meta property="og:url" content="/implement-azure-service-fabric-apps/" /><meta property="og:site_name" content="Programming With Wolfgang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-07-15T21:03:41+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Design and Implement Azure Service Fabric apps" /><meta name="twitter:site" content="@wolfgang_ofner" /><meta name="twitter:creator" content="@Wolfgang Ofner" /><meta name="google-site-verification" content="xxsPm-h6A0B6a0QMgqXO80PU4DbMt4Dq06p-SGzB3TU" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Wolfgang Ofner"},"dateModified":"2018-07-15T21:03:41+02:00","datePublished":"2018-07-15T21:03:41+02:00","description":"Azure Service Fabric is a platform that makes it easy to package, deploy, and manage distributed solutions at scale. It provides an easy programming model.","headline":"Design and Implement Azure Service Fabric apps","mainEntityOfPage":{"@type":"WebPage","@id":"/implement-azure-service-fabric-apps/"},"url":"/implement-azure-service-fabric-apps/"}</script><title>Design and Implement Azure Service Fabric apps | Programming With Wolfgang</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Programming With Wolfgang"><meta name="application-name" content="Programming With Wolfgang"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> (function (c, l, a, r, i, t, y) { c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) }; t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i; y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y); })(window, document, "clarity", "script", "hc0wl2v6mn"); </script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/author/author-wolfgang-ofner.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Programming With Wolfgang</a></div><div class="site-subtitle font-italic">Let's talk programming</div></div><div class="w-100 d-flex justify-content-center"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span></div><ul class="w-100" style="margin-top: 1em;"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/speaking/" class="nav-link"> <i class="fa-fw fas fa-microphone ml-xl-3 mr-xl-3 unloaded"></i> <span>SPEAKING</span> </a><li class="nav-item"> <a href="/youtube/" class="nav-link"> <i class="fa-fw fas fa-video ml-xl-3 mr-xl-3 unloaded"></i> <span>YOUTUBE</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="w-100" style="margin-top: 1em; text-align: center;"> <img src="/assets/img/author/azure-solutions-architect-expert.png" alt="Azure Solutions Architect Expert" width="200px" height="200px"></div><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <a href="https://github.com/wolfgangofner" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/wolfgang_ofner" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/wolfgangofner" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.youtube.com/channel/UCmiFK5vpvsi6j6gD7W_rsVQ" aria-label="Youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="d-sm-none row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Design and Implement Azure Service Fabric apps</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><div style="visibility:hidden;"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Design and Implement Azure Service Fabric apps</h1><div class="post-meta text-muted d-flex flex-column"><div> <span> Posted <em class="" data-ts="1531681421" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 15, 2018 </em> </span> by <span class="author"> By <em> Wolfgang Ofner </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1647 words"> <em>19 min</em></span> read</div></div><div class="post-content"><p>Azure Service Fabric is a platform that makes it easy to package, deploy, and manage distributed solutions at scale. It provides an easy programming model for building microservice solutions with a simple, familiar, and easy to understand development experience that supports stateless and stateful services and actor patterns. In addition, to providing a packaging and deployment solution for these native components, Service Fabric also supports the deployment of guest executable and containers as part of the same managed and distributes system.</p><div class="table-responsive"><div class="table-wrapper"><table class="table table-striped table-bordered table-hover"><tr><td> Native and executable component<td> Description<tr><td> Stateless Services<td> Stateless-Fabric-aware services that run without a managed state.<tr><td> Stateful Services<td> Stateless-Fabric-aware services that run with a managed state where the state is close to the compute.<tr><td> Actors<td> A higher level programming model built on top of stateful services.<tr><td> Guest Executable<td> Can be any application or service that may be cognizant or not cognizant of Service Fabric.<tr><td> Containers<td> Both Linux and Windows containers are supported by Service Fabric and may be cognizant or not cognizant of Service Fabric.</table></div></div><h2 id="create-a-service-fabric-application"><span class="mr-2"> Create a Service Fabric application</span><a href="#create-a-service-fabric-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A Service Fabric application can consist of one or more services. The application defines the deployment package for the service, and each service can have its own configuration, code, and data. A Service Fabric cluster can host multiple applications, and each has its own independent deployment upgrade lifecycle.</p><p>To create a new Service Fabric application, follow these steps:</p><ol><li>Open Visual Studio and select File -&gt; New -&gt; Project.<li>In the New Project dialog, select Service Fabric Application within the Cloud category. Provide a name and click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-a-Service-Fabric-application.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Create-a-Service-Fabric-application.jpg" alt="Create a Service Fabric application" data-proofer-ignore></a><p> Create a Service Fabric application</p></div><ol start="3"><li> Select Stateful Service from the list of services and provide a name.<li> Click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Select-a-Template-for-your-Fabric-Service.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Select-a-Template-for-your-Fabric-Service.jpg" alt="Select a Template for your Fabric Service" data-proofer-ignore></a><p> Select a Template for your Fabric Service</p></div><ol start="5"><li> Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the service type that is initialized when the Service Fabric runtime starts the service.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-service-type-description.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/The-service-type-description.jpg" alt="The service type description" data-proofer-ignore></a><p> The service type description</p></div><h3 id="configure-your-service-fabric-application"><span class="mr-2">Configure your Service Fabric application</span><a href="#configure-your-service-fabric-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>A service type is created for the project. In this case, the type is defined in the Simulator.cs file. This service type is registered in Program.cs when the program starts so that the Service Fabric runtime knows which type to initialize when it creates an instance of the service.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Registering-a-service-type-in-the-main-method.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Registering-a-service-type-in-the-main-method.jpg" alt="Registering a service type in the main method" data-proofer-ignore></a><p> Registering a service type in the main method</p></div><ol start="2"><li> The template produces a default implementation for the service type, with a RunAsync method that increments a counter every second. This counter value is persisted with the service in a dictionary using the StateManager, available through the service base type StatefulService. This counter is used to represent the number of leads generated for the purpose of this example.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/RunAsync-which-increments-a-counter-every-second.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/RunAsync-which-increments-a-counter-every-second.jpg" alt="RunAsync which increments a counter every second" data-proofer-ignore></a><p> RunAsync which increments a counter every second</p></div><ol start="3"><li> The service will run, and increment the counter as it runs persisting the value, but by default, this service does not expose any methods for a client to call. Before you can create an RPC listener you have to add the required NuGet package, Microsoft.ServiceFabric.Services.Remoting.<li> Create a new service interface using the IService marker interface from the previously installed NuGet, that indicates this service can be called remotely.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-the-ISimulatorService-interface.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Create-the-ISimulatorService-interface.jpg" alt="Create the ISimulatorService interface" data-proofer-ignore></a><p> Create the ISimulatorService interface</p></div><ol start="5"><li> Implement the previously created interface on the Simulator service type, and include an implementation of the GetLeads method to return the value of the counter.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Implementation-of-the-GetLeads-method.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Implementation-of-the-GetLeads-method.jpg" alt="Implementation of the GetLeads method" data-proofer-ignore></a><p> Implementation of the GetLeads method</p></div><ol start="6"><li> To expose this method to clients, add an RPC listener to the service. Modify the CreateServiceReplicaListeners method in the Simulator service type implementation, to add a call to the CreateServiceReplicaListeners method.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Modify-the-CreateServiceReplicaListeners-method.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Modify-the-CreateServiceReplicaListeners-method.jpg" alt="Modify the CreateServiceReplicaListeners method" data-proofer-ignore></a><p> Modify the CreateServiceReplicaListeners method</p></div><h2 id="add-a-web-front-end-to-a-service-fabric-application"><span class="mr-2">Add a web front end to a Service Fabric application</span><a href="#add-a-web-front-end-to-a-service-fabric-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this section, I will create a web front end to call the stateful service endpoint which I create previously.</p><p>To add a web app to your Service Fabric application, follow these steps:</p><ol><li>Right-click the Services node of your Service Fabric application and select Add and then New Service Fabric Service…<li>In the template dialog, select Stateless ASP.NET Core, provide a name and click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-a-web-app-in-your-Service-Fabric-app.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Create-a-web-app-in-your-Service-Fabric-app.jpg" alt="Create a web app in your Service Fabric app" data-proofer-ignore></a><p> Create a web app in your Service Fabric app</p></div><ol start="3"><li> On the next page select Web Application (Model-View-Controller) and click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Select-the-mvc-template-for-your-web-app.png"><img loading="lazy" data-src="/assets/img/posts/2018/07/Select-the-mvc-template-for-your-web-app.png" alt="Select the mvc template for your web app" data-proofer-ignore></a><p> Select the MVC template for your web app</p></div><ol start="4"><li> Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the HTTP endpoint where your web app will listen for requests.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-HTTP-endpoint-description.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/The-HTTP-endpoint-description.jpg" alt="The HTTP endpoint description" data-proofer-ignore></a><p> The HTTP endpoint description</p></div><ol start="5"><li> The new WebApp type is defined in the WebApp.cs, which inherits from StatelessService. For the service to listen for HTTP requests, the CreateServiceInstanceListeners() method sets up the WebListener.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-WebApp-class.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/The-WebApp-class.jpg" alt="The WebApp class" data-proofer-ignore></a><p> The WebApp class</p></div><ol start="6"><li> The next step is to call the stateful service that returns the leads counter value, from the stateless web app.<li> Make a copy of the service interface defined for the service type, ISimulatorService.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-copied-ISimulatorService-interface.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/The-copied-ISimulatorService-interface.jpg" alt="The copied ISimulatorService interface" data-proofer-ignore></a><p> The copied ISimulatorService interface</p></div><ol start="8"><li> Modify the ConfigureServices instruction in the WebApp.cs to inject an instance of Fabric client.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-modified-CreateServiceInstanceListeners-method.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/The-modified-CreateServiceInstanceListeners-method.jpg" alt="The modified CreateServiceInstanceListeners method" data-proofer-ignore></a><p> The modified CreateServiceInstanceListeners method</p></div><ol start="9"><li> Modify the HomeController to use the FabricClient via dependency injection.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Inject-FabricClient-into-the-HomeController.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Inject-FabricClient-into-the-HomeController.jpg" alt="Inject FabricClient into the HomeController" data-proofer-ignore></a><p> Inject FabricClient into the HomeController</p></div><ol start="10"><li> Modify the Index method in the HomeController to use the FabricClient instance to call the Simulator service</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Modify-the-Index-method-to-call-the-Simulator-service.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Modify-the-Index-method-to-call-the-Simulator-service.jpg" alt="Modify the Index method to call the Simulator service" data-proofer-ignore></a><p> Modify the Index method to call the Simulator service</p></div><ol start="11"><li> Update the Index.cshtml view to display the counter for each partition.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Modify-the-Index.cshtml-view.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Modify-the-Index.cshtml-view.jpg" alt="Modify the Index.cshtml view" data-proofer-ignore></a><p> Modify the Index.cshtml view</p></div><h3 id="deploy-and-run-your-web-app"><span class="mr-2">Deploy and run your Web App</span><a href="#deploy-and-run-your-web-app" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>To run the web app and stateful service, you can publish it to the local Service Fabric cluster. Right-click the Service Fabric application node in the Solution Explorer and select Publish. From the Publish Service Fabric Application dialog, select a target profile matching one of the local cluster options, and click Publish.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Deploy-to-a-local-cluster-with-error-message.png"><img loading="lazy" data-src="/assets/img/posts/2018/07/Deploy-to-a-local-cluster-with-error-message.png" alt="Deploy to a local cluster with error message" data-proofer-ignore></a><p> Deploy to a local cluster with an error message</p></div><ol start="2"><li> If you get an error message as on the screenshot shown above, start PowerShell as administrator and run the following code: &amp; <span class="hljs-string">&#8220;<span class="hljs-variable">$ENV:ProgramFiles</span>\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1&#8243;</span>. This creates a local cluster.<li> The installation takes a couple of minutes.<li> Once the installation is done, close and re-open the Publish window and the error should be gone.<li> Deploy your application and then access your web app at http://localhost:8527 (or whatever port you configured in the ServiceManifest.xml in your web app).</ol><p>You can find the code of the demo on <a href="https://github.com/WolfgangOfner/Azure-ServiceFabricDemo" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="build-an-actor-based-service"><span class="mr-2">Build an Actor-based service</span><a href="#build-an-actor-based-service" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The actor model is a superset of the Service Fabric stateful model. Actors are simple POCO objects that have many features that make them an isolated, independent unit of compute and state with single-threaded execution.</p><p>To create a new Service Fabric application based on the Actor service template, follow these steps:</p><ol><li>Open Visual Studio and select File -&gt; New -&gt; Project.<li>In the Cloud category select Service Fabric Application, provide a name and click OK.<li>Select Actor Service from the templates list, provide a name and Click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-an-Actor-service.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Create-an-Actor-service.jpg" alt="Create an Actor service" data-proofer-ignore></a><p> Create an Actor service</p></div><h2 id="monitor-and-diagnose-services"><span class="mr-2">Monitor and diagnose services</span><a href="#monitor-and-diagnose-services" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Azure portal offers several features to monitor and evaluate the performance or resource consumption of your application at runtime.</p><h2 id="deploy-an-application-to-a-container"><span class="mr-2">Deploy an application to a container</span><a href="#deploy-an-application-to-a-container" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Service Fabric can run processes and containers side by side, and containers can be Linux or Windows based containers. If you have an existing container image and wish to deploy this to an existing Service Fabric cluster, you can follow these steps to create a new Service Fabric application and set it up to deploy and run the container in your cluster.</p><ol><li>Open Visual Studio and select File -&gt; New -&gt; Project.<li>In the Cloud category select Service Fabric Application, provide a name and click OK.<li>Select Container from the templates list, provide a name and container image and Click OK.<li>Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. Modify the Resources section to add a UriScheme, Port and Protocol setting for the service point.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Add-a-UriScheme-Port-and-Protocol-to-the-ServiceManifest.xml-file.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Add-a-UriScheme-Port-and-Protocol-to-the-ServiceManifest.xml-file.jpg" alt="Add a UriScheme, Port and Protocol to the ServiceManifest.xml file" data-proofer-ignore></a><p> Add a UriScheme, Port and Protocol to the ServiceManifest.xml file</p></div><ol start="5"><li> Open the ApplicationManifest.xml file. Create a policy for the container to host a PortBinding by adding the Policies section to the ServiceManifestImport section. Additionally, indicate the container port for your container.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-a-PortBinding-policy-for-the-container.jpg"><img loading="lazy" data-src="/assets/img/posts/2018/07/Create-a-PortBinding-policy-for-the-container.jpg" alt="Create a PortBinding policy for the container" data-proofer-ignore></a><p> Create a PortBinding policy for the container</p></div><ol start="6"><li> The application is configured and ready to be published.</ol><h2 id="migrate-apps-from-cloud-services"><span class="mr-2">Migrate apps from cloud services</span><a href="#migrate-apps-from-cloud-services" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You can migrate your existing cloud service, both web and worker roles to Service Fabric applications.</p><h2 id="scale-a-service-fabric-app"><span class="mr-2">Scale a Service Fabric app</span><a href="#scale-a-service-fabric-app" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To scale a Service Fabric app, you have to understand Instances, Partitions, and Replicas.</p><p>By default, the Service Fabric tooling produces three publish profiles that you can use to deploy your application.</p><div class="table-responsive"><div class="table-wrapper"><table class="table table-striped table-bordered table-hover"><tr><td> Publish profile<td> Description<tr><td> Local.1Node.xml<td> To deploy against the local 1-node cluster.<tr><td> Local.5Node.xml<td> To deploy against the local 5-node cluster.<tr><td> Cloud.xml<td> To deploy against a Cloud cluster.</table></div></div><p>The publish profiles indicate the settings for the number of instances and partitions for each service.</p><div class="table-responsive"><div class="table-wrapper"><table class="table table-striped table-bordered table-hover"><tr><td> Publish profile parameter<td> Description<tr><td> WebApp_InstanceCount<td> Specifies the number of instances the WebApp service must have within the cluster.<tr><td> Simulator_PartitionCount<td> Specifies the number of partitions (for the stateful service) the Simulator service must have within the cluster.<tr><td> Simulator_MinReplicaSetSize<td> Specifies the minimum number of replicas required for each partition that the WebApp service should have within the cluster.<tr><td> Simulator_TargetReplicaSetSize<td> Specifies the number of target replicas required for each partition that the WebApp service should have within the cluster.</table></div></div><h2 id="create-secure-upgrade-and-save-service-fabric-cluster-in-azure"><span class="mr-2">Create, secure, upgrade, and save Service Fabric Cluster in Azure</span><a href="#create-secure-upgrade-and-save-service-fabric-cluster-in-azure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To publish your Service Fabric application to Azure in production, you will create a cluster and have to learn how to secure it. Also, you should know how to upgrade applications with zero downtime, and configure the application to scale following Azure’s best practices</p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This post gave an overview of Azure Service Fabric and its features and how to deploy it.</p><p>For more information about the 70-532 exam get the <a href="http://amzn.to/2EWNWMF" target="_blank" rel="noopener">Exam Ref book from Microsoft</a> and continue reading my blog posts. I am covering all topics needed to pass the exam. You can find an overview of all posts related to the 70-532 exam <a href="/prepared-for-the-70-532-exam/" target="_blank" rel="noopener">here</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cloud/'>Cloud</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/70-532/" class="post-tag no-text-decoration" >70-532</a> <a href="/tags/azure/" class="post-tag no-text-decoration" >Azure</a> <a href="/tags/certification/" class="post-tag no-text-decoration" >Certification</a> <a href="/tags/exam/" class="post-tag no-text-decoration" >Exam</a> <a href="/tags/learning/" class="post-tag no-text-decoration" >Learning</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Design+and+Implement+Azure+Service+Fabric+apps+-+Programming+With+Wolfgang&url=%2Fimplement-azure-service-fabric-apps%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Design+and+Implement+Azure+Service+Fabric+apps+-+Programming+With+Wolfgang&u=%2Fimplement-azure-service-fabric-apps%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Design+and+Implement+Azure+Service+Fabric+apps+-+Programming+With+Wolfgang&url=%2Fimplement-azure-service-fabric-apps%2F" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=%2Fimplement-azure-service-fabric-apps%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/aks/">AKS</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/azure-arc/">Azure Arc</a> <a class="post-tag" href="/tags/helm/">Helm</a> <a class="post-tag" href="/tags/youtube/">Youtube</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/prepared-for-the-70-532-exam/"><div class="card-body"> <em class="small" data-ts="1519392828" data-df="ll" > Feb 23, 2018 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How I prepared for the 70-532 Exam</h3><div class="text-muted small"><p> Recently I started to prepare for the Microsoft certification exam 70-532 “Developing Microsoft Azure Solutions” using the official Exam Ref book. This post contains a comprehensive list of blog po...</p></div></div></a></div><div class="card"> <a href="/deploy-workload-on-azure-arm-virtual-machines/"><div class="card-body"> <em class="small" data-ts="1520255937" data-df="ll" > Mar 5, 2018 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Deploy workload on Azure ARM virtual machines</h3><div class="text-muted small"><p> Azure ARM virtual machines can run a lot of different operating systems. In this posts, I will give an overview of these different types and I will also show how to create them in the Azure Portal....</p></div></div></a></div><div class="card"> <a href="/perform-configuration-management/"><div class="card-body"> <em class="small" data-ts="1520335271" data-df="ll" > Mar 6, 2018 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Perform Configuration Management</h3><div class="text-muted small"><p> In this post, I want to show how to use Windows PowerShell Desired State Configuration (DSC) and the VM Agent to perform various configuration management tasks like remote debugging and at the end,...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/implement-azure-functions-webjobs/" class="btn btn-outline-primary" prompt="Older"><p>Implement Azure Functions and WebJobs</p></a> <a href="/implement-third-party-paas/" class="btn btn-outline-primary" prompt="Newer"><p>Design and implement third-party PaaS</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = '/implement-azure-service-fabric-apps/'; this.page.identifier = '/implement-azure-service-fabric-apps/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://programmingwithwolfgang.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/aks/">AKS</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/azure-arc/">Azure Arc</a> <a class="post-tag" href="/tags/helm/">Helm</a> <a class="post-tag" href="/tags/youtube/">Youtube</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-112077092-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-112077092-1'); }); </script>
