<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Design and Implement Azure Service Fabric apps" /><meta name="author" content="Wolfgang Ofner" /><meta property="og:locale" content="en_US" /><meta name="description" content="Azure Service Fabric is a platform that makes it easy to package, deploy, and manage distributed solutions at scale. It provides an easy programming model for building microservice solutions with a simple, familiar, and easy to understand development experience that supports stateless and stateful services and actor patterns. In addition, to providing a packaging and deployment solution for these native components, Service Fabric also supports the deployment of guest executable and containers as part of the same managed and distributes system. Native and executable component Description Stateless Services Stateless-Fabric-aware services that run without a managed state. Stateful Services Stateless-Fabric-aware services that run with a managed state where the state is close to the compute. Actors A higher level programming model built on top of stateful services. Guest Executable Can be any application or service that may be cognizant or not cognizant of Service Fabric. Containers Both Linux and Windows containers are supported by Service Fabric and may be cognizant or not cognizant of Service Fabric.  Create a Service Fabric application A Service Fabric application can consist of one or more services. The application defines the deployment package for the service, and each service can have its own configuration, code, and data. A Service Fabric cluster can host multiple applications, and each has its own independent deployment upgrade lifecycle. To create a new Service Fabric application, follow these steps: Open Visual Studio and select File -&gt; New -&gt; Project. In the New Project dialog, select Service Fabric Application within the Cloud category. Provide a name and click OK. Create a Service Fabric application Select Stateful Service from the list of services and provide a name. Click OK. Select a Template for your Fabric Service Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the service type that is initialized when the Service Fabric runtime starts the service. The service type description Configure your Service Fabric application A service type is created for the project. In this case, the type is defined in the Simulator.cs file. This service type is registered in Program.cs when the program starts so that the Service Fabric runtime knows which type to initialize when it creates an instance of the service. Registering a service type in the main method The template produces a default implementation for the service type, with a RunAsync method that increments a counter every second. This counter value is persisted with the service in a dictionary using the StateManager, available through the service base type StatefulService. This counter is used to represent the number of leads generated for the purpose of this example. RunAsync which increments a counter every second The service will run, and increment the counter as it runs persisting the value, but by default, this service does not expose any methods for a client to call. Before you can create an RPC listener you have to add the required NuGet package, Microsoft.ServiceFabric.Services.Remoting. Create a new service interface using the IService marker interface from the previously installed NuGet, that indicates this service can be called remotely. Create the ISimulatorService interface Implement the previously created interface on the Simulator service type, and include an implementation of the GetLeads method to return the value of the counter. Implementation of the GetLeads method To expose this method to clients, add an RPC listener to the service. Modify the CreateServiceReplicaListeners method in the Simulator service type implementation, to add a call to the CreateServiceReplicaListeners method. Modify the CreateServiceReplicaListeners method Add a web front end to a Service Fabric application In this section, I will create a web front end to call the stateful service endpoint which I create previously. To add a web app to your Service Fabric application, follow these steps: Right-click the Services node of your Service Fabric application and select Add and then New Service Fabric Service… In the template dialog, select Stateless ASP.NET Core, provide a name and click OK. Create a web app in your Service Fabric app On the next page select Web Application (Model-View-Controller) and click OK. Select the MVC template for your web app Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the HTTP endpoint where your web app will listen for requests. The HTTP endpoint description The new WebApp type is defined in the WebApp.cs, which inherits from StatelessService. For the service to listen for HTTP requests, the CreateServiceInstanceListeners() method sets up the WebListener. The WebApp class The next step is to call the stateful service that returns the leads counter value, from the stateless web app. Make a copy of the service interface defined for the service type, ISimulatorService. The copied ISimulatorService interface Modify the ConfigureServices instruction in the WebApp.cs to inject an instance of Fabric client. The modified CreateServiceInstanceListeners method Modify the HomeController to use the FabricClient via dependency injection. Inject FabricClient into the HomeController Modify the Index method in the HomeController to use the FabricClient instance to call the Simulator service Modify the Index method to call the Simulator service Update the Index.cshtml view to display the counter for each partition. Modify the Index.cshtml view Deploy and run your Web App To run the web app and stateful service, you can publish it to the local Service Fabric cluster. Right-click the Service Fabric application node in the Solution Explorer and select Publish. From the Publish Service Fabric Application dialog, select a target profile matching one of the local cluster options, and click Publish. Deploy to a local cluster with an error message If you get an error message as on the screenshot shown above, start PowerShell as administrator and run the following code: &amp; &#8220;$ENV:ProgramFiles\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1&#8243;. This creates a local cluster. The installation takes a couple of minutes. Once the installation is done, close and re-open the Publish window and the error should be gone. Deploy your application and then access your web app at http://localhost:8527 (or whatever port you configured in the ServiceManifest.xml in your web app). You can find the code of the demo on GitHub. Build an Actor-based service The actor model is a superset of the Service Fabric stateful model. Actors are simple POCO objects that have many features that make them an isolated, independent unit of compute and state with single-threaded execution. To create a new Service Fabric application based on the Actor service template, follow these steps: Open Visual Studio and select File -&gt; New -&gt; Project. In the Cloud category select Service Fabric Application, provide a name and click OK. Select Actor Service from the templates list, provide a name and Click OK. Create an Actor service Monitor and diagnose services The Azure portal offers several features to monitor and evaluate the performance or resource consumption of your application at runtime. Deploy an application to a container Service Fabric can run processes and containers side by side, and containers can be Linux or Windows based containers. If you have an existing container image and wish to deploy this to an existing Service Fabric cluster, you can follow these steps to create a new Service Fabric application and set it up to deploy and run the container in your cluster. Open Visual Studio and select File -&gt; New -&gt; Project. In the Cloud category select Service Fabric Application, provide a name and click OK. Select Container from the templates list, provide a name and container image and Click OK. Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. Modify the Resources section to add a UriScheme, Port and Protocol setting for the service point. Add a UriScheme, Port and Protocol to the ServiceManifest.xml file Open the ApplicationManifest.xml file. Create a policy for the container to host a PortBinding by adding the Policies section to the ServiceManifestImport section. Additionally, indicate the container port for your container. Create a PortBinding policy for the container The application is configured and ready to be published. Migrate apps from cloud services You can migrate your existing cloud service, both web and worker roles to Service Fabric applications. Scale a Service Fabric app To scale a Service Fabric app, you have to understand Instances, Partitions, and Replicas. By default, the Service Fabric tooling produces three publish profiles that you can use to deploy your application. Publish profile Description Local.1Node.xml To deploy against the local 1-node cluster. Local.5Node.xml To deploy against the local 5-node cluster. Cloud.xml To deploy against a Cloud cluster. The publish profiles indicate the settings for the number of instances and partitions for each service. Publish profile parameter Description WebApp_InstanceCount Specifies the number of instances the WebApp service must have within the cluster. Simulator_PartitionCount Specifies the number of partitions (for the stateful service) the Simulator service must have within the cluster. Simulator_MinReplicaSetSize Specifies the minimum number of replicas required for each partition that the WebApp service should have within the cluster. Simulator_TargetReplicaSetSize Specifies the number of target replicas required for each partition that the WebApp service should have within the cluster. Create, secure, upgrade, and save Service Fabric Cluster in Azure To publish your Service Fabric application to Azure in production, you will create a cluster and have to learn how to secure it. Also, you should know how to upgrade applications with zero downtime, and configure the application to scale following Azure’s best practices Conclusion This post gave an overview of Azure Service Fabric and its features and how to deploy it. For more information about the 70-532 exam get the Exam Ref book from Microsoft and continue reading my blog posts. I am covering all topics needed to pass the exam. You can find an overview of all posts related to the 70-532 exam here." /><meta property="og:description" content="Azure Service Fabric is a platform that makes it easy to package, deploy, and manage distributed solutions at scale. It provides an easy programming model for building microservice solutions with a simple, familiar, and easy to understand development experience that supports stateless and stateful services and actor patterns. In addition, to providing a packaging and deployment solution for these native components, Service Fabric also supports the deployment of guest executable and containers as part of the same managed and distributes system. Native and executable component Description Stateless Services Stateless-Fabric-aware services that run without a managed state. Stateful Services Stateless-Fabric-aware services that run with a managed state where the state is close to the compute. Actors A higher level programming model built on top of stateful services. Guest Executable Can be any application or service that may be cognizant or not cognizant of Service Fabric. Containers Both Linux and Windows containers are supported by Service Fabric and may be cognizant or not cognizant of Service Fabric.  Create a Service Fabric application A Service Fabric application can consist of one or more services. The application defines the deployment package for the service, and each service can have its own configuration, code, and data. A Service Fabric cluster can host multiple applications, and each has its own independent deployment upgrade lifecycle. To create a new Service Fabric application, follow these steps: Open Visual Studio and select File -&gt; New -&gt; Project. In the New Project dialog, select Service Fabric Application within the Cloud category. Provide a name and click OK. Create a Service Fabric application Select Stateful Service from the list of services and provide a name. Click OK. Select a Template for your Fabric Service Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the service type that is initialized when the Service Fabric runtime starts the service. The service type description Configure your Service Fabric application A service type is created for the project. In this case, the type is defined in the Simulator.cs file. This service type is registered in Program.cs when the program starts so that the Service Fabric runtime knows which type to initialize when it creates an instance of the service. Registering a service type in the main method The template produces a default implementation for the service type, with a RunAsync method that increments a counter every second. This counter value is persisted with the service in a dictionary using the StateManager, available through the service base type StatefulService. This counter is used to represent the number of leads generated for the purpose of this example. RunAsync which increments a counter every second The service will run, and increment the counter as it runs persisting the value, but by default, this service does not expose any methods for a client to call. Before you can create an RPC listener you have to add the required NuGet package, Microsoft.ServiceFabric.Services.Remoting. Create a new service interface using the IService marker interface from the previously installed NuGet, that indicates this service can be called remotely. Create the ISimulatorService interface Implement the previously created interface on the Simulator service type, and include an implementation of the GetLeads method to return the value of the counter. Implementation of the GetLeads method To expose this method to clients, add an RPC listener to the service. Modify the CreateServiceReplicaListeners method in the Simulator service type implementation, to add a call to the CreateServiceReplicaListeners method. Modify the CreateServiceReplicaListeners method Add a web front end to a Service Fabric application In this section, I will create a web front end to call the stateful service endpoint which I create previously. To add a web app to your Service Fabric application, follow these steps: Right-click the Services node of your Service Fabric application and select Add and then New Service Fabric Service… In the template dialog, select Stateless ASP.NET Core, provide a name and click OK. Create a web app in your Service Fabric app On the next page select Web Application (Model-View-Controller) and click OK. Select the MVC template for your web app Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the HTTP endpoint where your web app will listen for requests. The HTTP endpoint description The new WebApp type is defined in the WebApp.cs, which inherits from StatelessService. For the service to listen for HTTP requests, the CreateServiceInstanceListeners() method sets up the WebListener. The WebApp class The next step is to call the stateful service that returns the leads counter value, from the stateless web app. Make a copy of the service interface defined for the service type, ISimulatorService. The copied ISimulatorService interface Modify the ConfigureServices instruction in the WebApp.cs to inject an instance of Fabric client. The modified CreateServiceInstanceListeners method Modify the HomeController to use the FabricClient via dependency injection. Inject FabricClient into the HomeController Modify the Index method in the HomeController to use the FabricClient instance to call the Simulator service Modify the Index method to call the Simulator service Update the Index.cshtml view to display the counter for each partition. Modify the Index.cshtml view Deploy and run your Web App To run the web app and stateful service, you can publish it to the local Service Fabric cluster. Right-click the Service Fabric application node in the Solution Explorer and select Publish. From the Publish Service Fabric Application dialog, select a target profile matching one of the local cluster options, and click Publish. Deploy to a local cluster with an error message If you get an error message as on the screenshot shown above, start PowerShell as administrator and run the following code: &amp; &#8220;$ENV:ProgramFiles\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1&#8243;. This creates a local cluster. The installation takes a couple of minutes. Once the installation is done, close and re-open the Publish window and the error should be gone. Deploy your application and then access your web app at http://localhost:8527 (or whatever port you configured in the ServiceManifest.xml in your web app). You can find the code of the demo on GitHub. Build an Actor-based service The actor model is a superset of the Service Fabric stateful model. Actors are simple POCO objects that have many features that make them an isolated, independent unit of compute and state with single-threaded execution. To create a new Service Fabric application based on the Actor service template, follow these steps: Open Visual Studio and select File -&gt; New -&gt; Project. In the Cloud category select Service Fabric Application, provide a name and click OK. Select Actor Service from the templates list, provide a name and Click OK. Create an Actor service Monitor and diagnose services The Azure portal offers several features to monitor and evaluate the performance or resource consumption of your application at runtime. Deploy an application to a container Service Fabric can run processes and containers side by side, and containers can be Linux or Windows based containers. If you have an existing container image and wish to deploy this to an existing Service Fabric cluster, you can follow these steps to create a new Service Fabric application and set it up to deploy and run the container in your cluster. Open Visual Studio and select File -&gt; New -&gt; Project. In the Cloud category select Service Fabric Application, provide a name and click OK. Select Container from the templates list, provide a name and container image and Click OK. Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. Modify the Resources section to add a UriScheme, Port and Protocol setting for the service point. Add a UriScheme, Port and Protocol to the ServiceManifest.xml file Open the ApplicationManifest.xml file. Create a policy for the container to host a PortBinding by adding the Policies section to the ServiceManifestImport section. Additionally, indicate the container port for your container. Create a PortBinding policy for the container The application is configured and ready to be published. Migrate apps from cloud services You can migrate your existing cloud service, both web and worker roles to Service Fabric applications. Scale a Service Fabric app To scale a Service Fabric app, you have to understand Instances, Partitions, and Replicas. By default, the Service Fabric tooling produces three publish profiles that you can use to deploy your application. Publish profile Description Local.1Node.xml To deploy against the local 1-node cluster. Local.5Node.xml To deploy against the local 5-node cluster. Cloud.xml To deploy against a Cloud cluster. The publish profiles indicate the settings for the number of instances and partitions for each service. Publish profile parameter Description WebApp_InstanceCount Specifies the number of instances the WebApp service must have within the cluster. Simulator_PartitionCount Specifies the number of partitions (for the stateful service) the Simulator service must have within the cluster. Simulator_MinReplicaSetSize Specifies the minimum number of replicas required for each partition that the WebApp service should have within the cluster. Simulator_TargetReplicaSetSize Specifies the number of target replicas required for each partition that the WebApp service should have within the cluster. Create, secure, upgrade, and save Service Fabric Cluster in Azure To publish your Service Fabric application to Azure in production, you will create a cluster and have to learn how to secure it. Also, you should know how to upgrade applications with zero downtime, and configure the application to scale following Azure’s best practices Conclusion This post gave an overview of Azure Service Fabric and its features and how to deploy it. For more information about the 70-532 exam get the Exam Ref book from Microsoft and continue reading my blog posts. I am covering all topics needed to pass the exam. You can find an overview of all posts related to the 70-532 exam here." /><link rel="canonical" href="https://www.programmingwithwolfgang.com/implement-azure-service-fabric-apps/" /><meta property="og:url" content="https://www.programmingwithwolfgang.com/implement-azure-service-fabric-apps/" /><meta property="og:site_name" content="Programming With Wolfgang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-07-15T21:03:41+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Design and Implement Azure Service Fabric apps" /><meta name="twitter:site" content="@wolfgang_ofner" /><meta name="twitter:creator" content="@Wolfgang Ofner" /><meta name="google-site-verification" content="xxsPm-h6A0B6a0QMgqXO80PU4DbMt4Dq06p-SGzB3TU" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.programmingwithwolfgang.com/implement-azure-service-fabric-apps/"},"author":{"@type":"Person","name":"Wolfgang Ofner"},"url":"https://www.programmingwithwolfgang.com/implement-azure-service-fabric-apps/","description":"Azure Service Fabric is a platform that makes it easy to package, deploy, and manage distributed solutions at scale. It provides an easy programming model for building microservice solutions with a simple, familiar, and easy to understand development experience that supports stateless and stateful services and actor patterns. In addition, to providing a packaging and deployment solution for these native components, Service Fabric also supports the deployment of guest executable and containers as part of the same managed and distributes system. Native and executable component Description Stateless Services Stateless-Fabric-aware services that run without a managed state. Stateful Services Stateless-Fabric-aware services that run with a managed state where the state is close to the compute. Actors A higher level programming model built on top of stateful services. Guest Executable Can be any application or service that may be cognizant or not cognizant of Service Fabric. Containers Both Linux and Windows containers are supported by Service Fabric and may be cognizant or not cognizant of Service Fabric.  Create a Service Fabric application A Service Fabric application can consist of one or more services. The application defines the deployment package for the service, and each service can have its own configuration, code, and data. A Service Fabric cluster can host multiple applications, and each has its own independent deployment upgrade lifecycle. To create a new Service Fabric application, follow these steps: Open Visual Studio and select File -&gt; New -&gt; Project. In the New Project dialog, select Service Fabric Application within the Cloud category. Provide a name and click OK. Create a Service Fabric application Select Stateful Service from the list of services and provide a name. Click OK. Select a Template for your Fabric Service Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the service type that is initialized when the Service Fabric runtime starts the service. The service type description Configure your Service Fabric application A service type is created for the project. In this case, the type is defined in the Simulator.cs file. This service type is registered in Program.cs when the program starts so that the Service Fabric runtime knows which type to initialize when it creates an instance of the service. Registering a service type in the main method The template produces a default implementation for the service type, with a RunAsync method that increments a counter every second. This counter value is persisted with the service in a dictionary using the StateManager, available through the service base type StatefulService. This counter is used to represent the number of leads generated for the purpose of this example. RunAsync which increments a counter every second The service will run, and increment the counter as it runs persisting the value, but by default, this service does not expose any methods for a client to call. Before you can create an RPC listener you have to add the required NuGet package, Microsoft.ServiceFabric.Services.Remoting. Create a new service interface using the IService marker interface from the previously installed NuGet, that indicates this service can be called remotely. Create the ISimulatorService interface Implement the previously created interface on the Simulator service type, and include an implementation of the GetLeads method to return the value of the counter. Implementation of the GetLeads method To expose this method to clients, add an RPC listener to the service. Modify the CreateServiceReplicaListeners method in the Simulator service type implementation, to add a call to the CreateServiceReplicaListeners method. Modify the CreateServiceReplicaListeners method Add a web front end to a Service Fabric application In this section, I will create a web front end to call the stateful service endpoint which I create previously. To add a web app to your Service Fabric application, follow these steps: Right-click the Services node of your Service Fabric application and select Add and then New Service Fabric Service… In the template dialog, select Stateless ASP.NET Core, provide a name and click OK. Create a web app in your Service Fabric app On the next page select Web Application (Model-View-Controller) and click OK. Select the MVC template for your web app Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the HTTP endpoint where your web app will listen for requests. The HTTP endpoint description The new WebApp type is defined in the WebApp.cs, which inherits from StatelessService. For the service to listen for HTTP requests, the CreateServiceInstanceListeners() method sets up the WebListener. The WebApp class The next step is to call the stateful service that returns the leads counter value, from the stateless web app. Make a copy of the service interface defined for the service type, ISimulatorService. The copied ISimulatorService interface Modify the ConfigureServices instruction in the WebApp.cs to inject an instance of Fabric client. The modified CreateServiceInstanceListeners method Modify the HomeController to use the FabricClient via dependency injection. Inject FabricClient into the HomeController Modify the Index method in the HomeController to use the FabricClient instance to call the Simulator service Modify the Index method to call the Simulator service Update the Index.cshtml view to display the counter for each partition. Modify the Index.cshtml view Deploy and run your Web App To run the web app and stateful service, you can publish it to the local Service Fabric cluster. Right-click the Service Fabric application node in the Solution Explorer and select Publish. From the Publish Service Fabric Application dialog, select a target profile matching one of the local cluster options, and click Publish. Deploy to a local cluster with an error message If you get an error message as on the screenshot shown above, start PowerShell as administrator and run the following code: &amp; &#8220;$ENV:ProgramFiles\\Microsoft SDKs\\Service Fabric\\ClusterSetup\\DevClusterSetup.ps1&#8243;. This creates a local cluster. The installation takes a couple of minutes. Once the installation is done, close and re-open the Publish window and the error should be gone. Deploy your application and then access your web app at http://localhost:8527 (or whatever port you configured in the ServiceManifest.xml in your web app). You can find the code of the demo on GitHub. Build an Actor-based service The actor model is a superset of the Service Fabric stateful model. Actors are simple POCO objects that have many features that make them an isolated, independent unit of compute and state with single-threaded execution. To create a new Service Fabric application based on the Actor service template, follow these steps: Open Visual Studio and select File -&gt; New -&gt; Project. In the Cloud category select Service Fabric Application, provide a name and click OK. Select Actor Service from the templates list, provide a name and Click OK. Create an Actor service Monitor and diagnose services The Azure portal offers several features to monitor and evaluate the performance or resource consumption of your application at runtime. Deploy an application to a container Service Fabric can run processes and containers side by side, and containers can be Linux or Windows based containers. If you have an existing container image and wish to deploy this to an existing Service Fabric cluster, you can follow these steps to create a new Service Fabric application and set it up to deploy and run the container in your cluster. Open Visual Studio and select File -&gt; New -&gt; Project. In the Cloud category select Service Fabric Application, provide a name and click OK. Select Container from the templates list, provide a name and container image and Click OK. Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. Modify the Resources section to add a UriScheme, Port and Protocol setting for the service point. Add a UriScheme, Port and Protocol to the ServiceManifest.xml file Open the ApplicationManifest.xml file. Create a policy for the container to host a PortBinding by adding the Policies section to the ServiceManifestImport section. Additionally, indicate the container port for your container. Create a PortBinding policy for the container The application is configured and ready to be published. Migrate apps from cloud services You can migrate your existing cloud service, both web and worker roles to Service Fabric applications. Scale a Service Fabric app To scale a Service Fabric app, you have to understand Instances, Partitions, and Replicas. By default, the Service Fabric tooling produces three publish profiles that you can use to deploy your application. Publish profile Description Local.1Node.xml To deploy against the local 1-node cluster. Local.5Node.xml To deploy against the local 5-node cluster. Cloud.xml To deploy against a Cloud cluster. The publish profiles indicate the settings for the number of instances and partitions for each service. Publish profile parameter Description WebApp_InstanceCount Specifies the number of instances the WebApp service must have within the cluster. Simulator_PartitionCount Specifies the number of partitions (for the stateful service) the Simulator service must have within the cluster. Simulator_MinReplicaSetSize Specifies the minimum number of replicas required for each partition that the WebApp service should have within the cluster. Simulator_TargetReplicaSetSize Specifies the number of target replicas required for each partition that the WebApp service should have within the cluster. Create, secure, upgrade, and save Service Fabric Cluster in Azure To publish your Service Fabric application to Azure in production, you will create a cluster and have to learn how to secure it. Also, you should know how to upgrade applications with zero downtime, and configure the application to scale following Azure’s best practices Conclusion This post gave an overview of Azure Service Fabric and its features and how to deploy it. For more information about the 70-532 exam get the Exam Ref book from Microsoft and continue reading my blog posts. I am covering all topics needed to pass the exam. You can find an overview of all posts related to the 70-532 exam here.","@type":"BlogPosting","headline":"Design and Implement Azure Service Fabric apps","dateModified":"2020-11-25T18:17:18+01:00","datePublished":"2018-07-15T21:03:41+02:00","@context":"https://schema.org"}</script><title>Design and Implement Azure Service Fabric apps | Programming With Wolfgang</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-112077092-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-112077092-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/author/wolfgang-small.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Programming With Wolfgang</a></div><div class="site-subtitle font-italic">Let's talk programming</div></div><div class="w-100 d-flex justify-content-center"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span></div><ul class="w-100" style="margin-top: 1em;"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/wolfgangofner" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/wolfgang_ofner" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/wolfgangofner" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['wolfgang','programmingwithwolfgang.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="d-sm-none row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Design and Implement Azure Service Fabric apps</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Design and Implement Azure Service Fabric apps</div><div style="visibility:hidden;"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel">Cancel</span></div></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Design and Implement Azure Service Fabric apps</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Jul 15, 2018, 9:03 PM +0200" > Jul 15, 2018 <i class="unloaded">2018-07-15T21:03:41+02:00</i> </span> by <span class="author"> Wolfgang Ofner </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Nov 25, 2020, 6:17 PM +0100" > Nov 25, 2020 <i class="unloaded">2020-11-25T18:17:18+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1647 words">19 min</span></div></div><div class="post-content"><p>Azure Service Fabric is a platform that makes it easy to package, deploy, and manage distributed solutions at scale. It provides an easy programming model for building microservice solutions with a simple, familiar, and easy to understand development experience that supports stateless and stateful services and actor patterns. In addition, to providing a packaging and deployment solution for these native components, Service Fabric also supports the deployment of guest executable and containers as part of the same managed and distributes system.</p><div class="table-responsive"><table class="table table-striped table-bordered table-hover"><tr><td> Native and executable component<td> Description<tr><td> Stateless Services<td> Stateless-Fabric-aware services that run without a managed state.<tr><td> Stateful Services<td> Stateless-Fabric-aware services that run with a managed state where the state is close to the compute.<tr><td> Actors<td> A higher level programming model built on top of stateful services.<tr><td> Guest Executable<td> Can be any application or service that may be cognizant or not cognizant of Service Fabric.<tr><td> Containers<td> Both Linux and Windows containers are supported by Service Fabric and may be cognizant or not cognizant of Service Fabric.</table></div><h2 id="create-a-service-fabric-application"> Create a Service Fabric application</h2><p>A Service Fabric application can consist of one or more services. The application defines the deployment package for the service, and each service can have its own configuration, code, and data. A Service Fabric cluster can host multiple applications, and each has its own independent deployment upgrade lifecycle.</p><p>To create a new Service Fabric application, follow these steps:</p><ol><li>Open Visual Studio and select File -&gt; New -&gt; Project.<li>In the New Project dialog, select Service Fabric Application within the Cloud category. Provide a name and click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-a-Service-Fabric-application.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Create-a-Service-Fabric-application.jpg" alt="Create a Service Fabric application" /></a><p> Create a Service Fabric application</p></div><ol start="3"><li> Select Stateful Service from the list of services and provide a name.<li> Click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Select-a-Template-for-your-Fabric-Service.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Select-a-Template-for-your-Fabric-Service.jpg" alt="Select a Template for your Fabric Service" /></a><p> Select a Template for your Fabric Service</p></div><ol start="5"><li> Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the service type that is initialized when the Service Fabric runtime starts the service.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-service-type-description.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/The-service-type-description.jpg" alt="The service type description" /></a><p> The service type description</p></div><h3 id="configure-your-service-fabric-application">Configure your Service Fabric application</h3><ol><li>A service type is created for the project. In this case, the type is defined in the Simulator.cs file. This service type is registered in Program.cs when the program starts so that the Service Fabric runtime knows which type to initialize when it creates an instance of the service.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Registering-a-service-type-in-the-main-method.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Registering-a-service-type-in-the-main-method.jpg" alt="Registering a service type in the main method" /></a><p> Registering a service type in the main method</p></div><ol start="2"><li> The template produces a default implementation for the service type, with a RunAsync method that increments a counter every second. This counter value is persisted with the service in a dictionary using the StateManager, available through the service base type StatefulService. This counter is used to represent the number of leads generated for the purpose of this example.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/RunAsync-which-increments-a-counter-every-second.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/RunAsync-which-increments-a-counter-every-second.jpg" alt="RunAsync which increments a counter every second" /></a><p> RunAsync which increments a counter every second</p></div><ol start="3"><li> The service will run, and increment the counter as it runs persisting the value, but by default, this service does not expose any methods for a client to call. Before you can create an RPC listener you have to add the required NuGet package, Microsoft.ServiceFabric.Services.Remoting.<li> Create a new service interface using the IService marker interface from the previously installed NuGet, that indicates this service can be called remotely.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-the-ISimulatorService-interface.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Create-the-ISimulatorService-interface.jpg" alt="Create the ISimulatorService interface" /></a><p> Create the ISimulatorService interface</p></div><ol start="5"><li> Implement the previously created interface on the Simulator service type, and include an implementation of the GetLeads method to return the value of the counter.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Implementation-of-the-GetLeads-method.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Implementation-of-the-GetLeads-method.jpg" alt="Implementation of the GetLeads method" /></a><p> Implementation of the GetLeads method</p></div><ol start="6"><li> To expose this method to clients, add an RPC listener to the service. Modify the CreateServiceReplicaListeners method in the Simulator service type implementation, to add a call to the CreateServiceReplicaListeners method.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Modify-the-CreateServiceReplicaListeners-method.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Modify-the-CreateServiceReplicaListeners-method.jpg" alt="Modify the CreateServiceReplicaListeners method" /></a><p> Modify the CreateServiceReplicaListeners method</p></div><h2 id="add-a-web-front-end-to-a-service-fabric-application">Add a web front end to a Service Fabric application</h2><p>In this section, I will create a web front end to call the stateful service endpoint which I create previously.</p><p>To add a web app to your Service Fabric application, follow these steps:</p><ol><li>Right-click the Services node of your Service Fabric application and select Add and then New Service Fabric Service…<li>In the template dialog, select Stateless ASP.NET Core, provide a name and click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-a-web-app-in-your-Service-Fabric-app.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Create-a-web-app-in-your-Service-Fabric-app.jpg" alt="Create a web app in your Service Fabric app" /></a><p> Create a web app in your Service Fabric app</p></div><ol start="3"><li> On the next page select Web Application (Model-View-Controller) and click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Select-the-mvc-template-for-your-web-app.png"><img loading="lazy" src="/assets/img/posts/2018/07/Select-the-mvc-template-for-your-web-app.png" alt="Select the mvc template for your web app" /></a><p> Select the MVC template for your web app</p></div><ol start="4"><li> Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. This file describes the service deployment package and related information. It includes a section that describes the HTTP endpoint where your web app will listen for requests.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-HTTP-endpoint-description.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/The-HTTP-endpoint-description.jpg" alt="The HTTP endpoint description" /></a><p> The HTTP endpoint description</p></div><ol start="5"><li> The new WebApp type is defined in the WebApp.cs, which inherits from StatelessService. For the service to listen for HTTP requests, the CreateServiceInstanceListeners() method sets up the WebListener.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-WebApp-class.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/The-WebApp-class.jpg" alt="The WebApp class" /></a><p> The WebApp class</p></div><ol start="6"><li> The next step is to call the stateful service that returns the leads counter value, from the stateless web app.<li> Make a copy of the service interface defined for the service type, ISimulatorService.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-copied-ISimulatorService-interface.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/The-copied-ISimulatorService-interface.jpg" alt="The copied ISimulatorService interface" /></a><p> The copied ISimulatorService interface</p></div><ol start="8"><li> Modify the ConfigureServices instruction in the WebApp.cs to inject an instance of Fabric client.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/The-modified-CreateServiceInstanceListeners-method.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/The-modified-CreateServiceInstanceListeners-method.jpg" alt="The modified CreateServiceInstanceListeners method" /></a><p> The modified CreateServiceInstanceListeners method</p></div><ol start="9"><li> Modify the HomeController to use the FabricClient via dependency injection.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Inject-FabricClient-into-the-HomeController.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Inject-FabricClient-into-the-HomeController.jpg" alt="Inject FabricClient into the HomeController" /></a><p> Inject FabricClient into the HomeController</p></div><ol start="10"><li> Modify the Index method in the HomeController to use the FabricClient instance to call the Simulator service</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Modify-the-Index-method-to-call-the-Simulator-service.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Modify-the-Index-method-to-call-the-Simulator-service.jpg" alt="Modify the Index method to call the Simulator service" /></a><p> Modify the Index method to call the Simulator service</p></div><ol start="11"><li> Update the Index.cshtml view to display the counter for each partition.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Modify-the-Index.cshtml-view.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Modify-the-Index.cshtml-view.jpg" alt="Modify the Index.cshtml view" /></a><p> Modify the Index.cshtml view</p></div><h3 id="deploy-and-run-your-web-app">Deploy and run your Web App</h3><ol><li>To run the web app and stateful service, you can publish it to the local Service Fabric cluster. Right-click the Service Fabric application node in the Solution Explorer and select Publish. From the Publish Service Fabric Application dialog, select a target profile matching one of the local cluster options, and click Publish.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Deploy-to-a-local-cluster-with-error-message.png"><img loading="lazy" src="/assets/img/posts/2018/07/Deploy-to-a-local-cluster-with-error-message.png" alt="Deploy to a local cluster with error message" /></a><p> Deploy to a local cluster with an error message</p></div><ol start="2"><li> If you get an error message as on the screenshot shown above, start PowerShell as administrator and run the following code: &amp; <span class="hljs-string">&#8220;<span class="hljs-variable">$ENV:ProgramFiles</span>\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1&#8243;</span>. This creates a local cluster.<li> The installation takes a couple of minutes.<li> Once the installation is done, close and re-open the Publish window and the error should be gone.<li> Deploy your application and then access your web app at http://localhost:8527 (or whatever port you configured in the ServiceManifest.xml in your web app).</ol><p>You can find the code of the demo on <a href="https://github.com/WolfgangOfner/Azure-ServiceFabricDemo" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="build-an-actor-based-service">Build an Actor-based service</h2><p>The actor model is a superset of the Service Fabric stateful model. Actors are simple POCO objects that have many features that make them an isolated, independent unit of compute and state with single-threaded execution.</p><p>To create a new Service Fabric application based on the Actor service template, follow these steps:</p><ol><li>Open Visual Studio and select File -&gt; New -&gt; Project.<li>In the Cloud category select Service Fabric Application, provide a name and click OK.<li>Select Actor Service from the templates list, provide a name and Click OK.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-an-Actor-service.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Create-an-Actor-service.jpg" alt="Create an Actor service" /></a><p> Create an Actor service</p></div><h2 id="monitor-and-diagnose-services">Monitor and diagnose services</h2><p>The Azure portal offers several features to monitor and evaluate the performance or resource consumption of your application at runtime.</p><h2 id="deploy-an-application-to-a-container">Deploy an application to a container</h2><p>Service Fabric can run processes and containers side by side, and containers can be Linux or Windows based containers. If you have an existing container image and wish to deploy this to an existing Service Fabric cluster, you can follow these steps to create a new Service Fabric application and set it up to deploy and run the container in your cluster.</p><ol><li>Open Visual Studio and select File -&gt; New -&gt; Project.<li>In the Cloud category select Service Fabric Application, provide a name and click OK.<li>Select Container from the templates list, provide a name and container image and Click OK.<li>Expand the PackageRoot folder in the Solution Explorer and you will find the ServiceManifest.xml file there. Modify the Resources section to add a UriScheme, Port and Protocol setting for the service point.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Add-a-UriScheme-Port-and-Protocol-to-the-ServiceManifest.xml-file.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Add-a-UriScheme-Port-and-Protocol-to-the-ServiceManifest.xml-file.jpg" alt="Add a UriScheme, Port and Protocol to the ServiceManifest.xml file" /></a><p> Add a UriScheme, Port and Protocol to the ServiceManifest.xml file</p></div><ol start="5"><li> Open the ApplicationManifest.xml file. Create a policy for the container to host a PortBinding by adding the Policies section to the ServiceManifestImport section. Additionally, indicate the container port for your container.</ol><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2018/07/Create-a-PortBinding-policy-for-the-container.jpg"><img loading="lazy" src="/assets/img/posts/2018/07/Create-a-PortBinding-policy-for-the-container.jpg" alt="Create a PortBinding policy for the container" /></a><p> Create a PortBinding policy for the container</p></div><ol start="6"><li> The application is configured and ready to be published.</ol><h2 id="migrate-apps-from-cloud-services">Migrate apps from cloud services</h2><p>You can migrate your existing cloud service, both web and worker roles to Service Fabric applications.</p><h2 id="scale-a-service-fabric-app">Scale a Service Fabric app</h2><p>To scale a Service Fabric app, you have to understand Instances, Partitions, and Replicas.</p><p>By default, the Service Fabric tooling produces three publish profiles that you can use to deploy your application.</p><div class="table-responsive"><table class="table table-striped table-bordered table-hover"><tr><td> Publish profile<td> Description<tr><td> Local.1Node.xml<td> To deploy against the local 1-node cluster.<tr><td> Local.5Node.xml<td> To deploy against the local 5-node cluster.<tr><td> Cloud.xml<td> To deploy against a Cloud cluster.</table></div><p>The publish profiles indicate the settings for the number of instances and partitions for each service.</p><div class="table-responsive"><table class="table table-striped table-bordered table-hover"><tr><td> Publish profile parameter<td> Description<tr><td> WebApp_InstanceCount<td> Specifies the number of instances the WebApp service must have within the cluster.<tr><td> Simulator_PartitionCount<td> Specifies the number of partitions (for the stateful service) the Simulator service must have within the cluster.<tr><td> Simulator_MinReplicaSetSize<td> Specifies the minimum number of replicas required for each partition that the WebApp service should have within the cluster.<tr><td> Simulator_TargetReplicaSetSize<td> Specifies the number of target replicas required for each partition that the WebApp service should have within the cluster.</table></div><h2 id="create-secure-upgrade-and-save-service-fabric-cluster-in-azure">Create, secure, upgrade, and save Service Fabric Cluster in Azure</h2><p>To publish your Service Fabric application to Azure in production, you will create a cluster and have to learn how to secure it. Also, you should know how to upgrade applications with zero downtime, and configure the application to scale following Azure’s best practices</p><h2 id="conclusion">Conclusion</h2><p>This post gave an overview of Azure Service Fabric and its features and how to deploy it.</p><p>For more information about the 70-532 exam get the <a href="http://amzn.to/2EWNWMF" target="_blank" rel="noopener">Exam Ref book from Microsoft</a> and continue reading my blog posts. I am covering all topics needed to pass the exam. You can find an overview of all posts related to the 70-532 exam <a href="/prepared-for-the-70-532-exam/" target="_blank" rel="noopener">here</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cloud/'>Cloud</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/70-532/" class="post-tag no-text-decoration" >70-532</a> <a href="/tags/azure/" class="post-tag no-text-decoration" >Azure</a> <a href="/tags/certification/" class="post-tag no-text-decoration" >Certification</a> <a href="/tags/exam/" class="post-tag no-text-decoration" >Exam</a> <a href="/tags/learning/" class="post-tag no-text-decoration" >Learning</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Design and Implement Azure Service Fabric apps - Programming With Wolfgang&url=https://www.programmingwithwolfgang.com/implement-azure-service-fabric-apps/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Design and Implement Azure Service Fabric apps - Programming With Wolfgang&u=https://www.programmingwithwolfgang.com/implement-azure-service-fabric-apps/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Design and Implement Azure Service Fabric apps - Programming With Wolfgang&url=https://www.programmingwithwolfgang.com/implement-azure-service-fabric-apps/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.programmingwithwolfgang.com/implement-azure-service-fabric-apps/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/deploy-dacpac-linux-azure-devops/">Automatically Deploy your Database with Dacpac Packages using Linux and Azure DevOps</a><li><a href="/microservice-series-from-zero-to-hero/">Microservice Series - From Zero to Hero</a><li><a href="/azure-kubernetes-service-getting-started/">Azure Kubernetes Service - Getting Started</a><li><a href="/analyze-software-architecture-ndepend/">Analyze Software Architecture with NDepend</a><li><a href="/automatically-deploy-database-changes/">Automatically deploy Database Changes with SSDT</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/learning/">Learning</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/70-532/">70-532</a> <a class="post-tag" href="/tags/certification/">Certification</a> <a class="post-tag" href="/tags/exam/">Exam</a> <a class="post-tag" href="/tags/net-core/">NET Core</a> <a class="post-tag" href="/tags/ci/">CI</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/implement-azure-cosmos-db-documentdb/"><div class="card-body"> <span class="timeago small" > Apr 30, 2018 <i class="unloaded">2018-04-30T00:48:42+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Implement Azure Cosmos DB DocumentDB</h3><div class="text-muted small"><p> Azure Cosmos DB DocumentDB is a JSON document store NoSQL database, similar to MongoDB. JSON document stores are the fastest growing NoSQL solutions. The reason why it’s growing so fast is that it ...</p></div></div></a></div><div class="card"> <a href="/implement-redis-cache-azure/"><div class="card-body"> <span class="timeago small" > May 1, 2018 <i class="unloaded">2018-05-01T20:10:55+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Implement Redis Cache in Azure</h3><div class="text-muted small"><p> Redis Cache is a key-value store NoSQL database. Its implementation is very similar to Azure Table Storage. The main difference is Redis is very high performing by keeping the data in memory most o...</p></div></div></a></div><div class="card"> <a href="/implement-azure-search/"><div class="card-body"> <span class="timeago small" > May 2, 2018 <i class="unloaded">2018-05-02T17:05:35+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Implement Azure Search</h3><div class="text-muted small"><p> Azure Search is a Platform as a Service offering that gives developers APIs needed to add search functionality to their applications. Primarily this means full-text search. The typical example is h...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/implement-azure-functions-webjobs/" class="btn btn-outline-primary"><p>Implement Azure Functions and WebJobs</p></a> <a href="/implement-third-party-paas/" class="btn btn-outline-primary"><p>Design and implement third-party PaaS</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//programmingwithwolfgang.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://www.programmingwithwolfgang.com/implement-azure-service-fabric-apps/'; this.page.identifier = '/implement-azure-service-fabric-apps/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/wolfgang_ofner">Wolfgang Ofner</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/learning/">Learning</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/70-532/">70 532</a> <a class="post-tag" href="/tags/certification/">Certification</a> <a class="post-tag" href="/tags/exam/">Exam</a> <a class="post-tag" href="/tags/net-core/">NET Core</a> <a class="post-tag" href="/tags/ci/">CI</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.programmingwithwolfgang.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
