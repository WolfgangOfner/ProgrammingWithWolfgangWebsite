<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Replace RabbitMQ with Azure Service Bus Queues" /><meta name="author" content="Wolfgang Ofner" /><meta property="og:locale" content="en_US" /><meta name="description" content="Replace RabbitMQ with Azure Service Bus Queues to take advantage of the managed and scalable queue on Azure." /><meta property="og:description" content="Replace RabbitMQ with Azure Service Bus Queues to take advantage of the managed and scalable queue on Azure." /><link rel="canonical" href="https://www.programmingwithwolfgang.com/replace-rabbitmq-azure-service-bus-queue/" /><meta property="og:url" content="https://www.programmingwithwolfgang.com/replace-rabbitmq-azure-service-bus-queue/" /><meta property="og:site_name" content="Programming With Wolfgang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-12T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Replace RabbitMQ with Azure Service Bus Queues" /><meta name="twitter:site" content="@wolfgang_ofner" /><meta name="twitter:creator" content="@Wolfgang Ofner" /><meta name="google-site-verification" content="xxsPm-h6A0B6a0QMgqXO80PU4DbMt4Dq06p-SGzB3TU" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Wolfgang Ofner"},"@type":"BlogPosting","headline":"Replace RabbitMQ with Azure Service Bus Queues","dateModified":"2021-09-12T18:20:18+02:00","description":"Replace RabbitMQ with Azure Service Bus Queues to take advantage of the managed and scalable queue on Azure.","datePublished":"2021-04-12T00:00:00+02:00","url":"https://www.programmingwithwolfgang.com/replace-rabbitmq-azure-service-bus-queue/","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.programmingwithwolfgang.com/replace-rabbitmq-azure-service-bus-queue/"},"@context":"https://schema.org"}</script><title>Replace RabbitMQ with Azure Service Bus Queues | Programming With Wolfgang</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-112077092-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-112077092-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/author/author-wolfgang-ofner.jpg" alt="author wolfgang ofner" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Programming With Wolfgang</a></div><div class="site-subtitle font-italic">Let's talk programming</div></div><div class="w-100 d-flex justify-content-center"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span></div><ul class="w-100" style="margin-top: 1em;"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/wolfgangofner" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/wolfgang_ofner" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/wolfgangofner" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['wolfgang','programmingwithwolfgang.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="d-sm-none row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Replace RabbitMQ with Azure Service Bus Queues</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Replace RabbitMQ with Azure Service Bus Queues</div><div style="visibility:hidden;"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel">Cancel</span></div></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Replace RabbitMQ with Azure Service Bus Queues</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 12, 2021, 12:00 AM +0200" > Apr 12 <i class="unloaded">2021-04-12T00:00:00+02:00</i> </span> by <span class="author"> Wolfgang Ofner </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Sep 12, 2021, 6:20 PM +0200" > Sep 12 <i class="unloaded">2021-09-12T18:20:18+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1140 words">13 min</span></div></div><div class="post-content"><p>RabbitMQ is a great tool to connect microservices asynchronously but it also comes with a couple of downsides. The biggest downside is that you have to take care of running, monitoring, and updating it. Running a RabbitMQ Docker image in Kubernetes is quite easy but still requires some management. One of the best features of cloud provides are the platform as a service (PaaS) offerings. This means that the cloud provider, for example, Azure runs the platform for you and you don’t have to take care of updating or patching the software.</p><p>In this post, I will add a new class to my microservice so I can switch between RabbitMQ and Azure Service Bus.</p><h2 id="what-is-azure-service-bus">What is Azure Service Bus</h2><p>Azure Service Bus is an enterprise messaging PaaS solution with many useful features. Some of these features are:</p><ul><li>Queues<li>Topics (one sender, multiple subscribers)<li>Transaction<li>Duplication filter<li>Dead message queues<li>Geo-disaster recovery</ul><p>Since it is a PaaS offering, Azure is managing the infrastructure which means that you as a developer can focus on implementing it and don’t have to think about maintenance, upgrading, or monitoring of it. For this demo, I am using the Basic tier which has very limited features but only costs 0.043€ per million operations. In your production environment, you most likely will use the Standard tier.</p><h3 id="difference-between-azure-service-bus-and-azure-queue">Difference between Azure Service Bus and Azure Queue</h3><p>Both queue solutions are very similar but Azure Service Bus comes with a First-In-First-Out guarantee. Additionally, it has more enterprise features in the Standard and Premium tier. For a more detailed comparison between Azure Service Bus and Azure Queue, see the <a href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted" target="_blank" rel="noopener noreferrer">documentation</a>.</p><h2 id="create-a-new-azure-service-bus-queue">Create a new Azure Service Bus Queue</h2><p>First, you have to create an Azure Service Bus Namespace. In the Azure Portal, search for Service Bus and click on Create.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/04/Create-a-new-Service-Bus-Namespace.jpg"><img loading="lazy" src="/assets/img/posts/2021/04/Create-a-new-Service-Bus-Namespace.jpg" alt="Create a new Service Bus Namespace" /></a><p> Create a new Service Bus Namespace</p></div><p>Select your subscription, resource group, location, and pricing tier, and then provide a unique name. Click on Create and the Service Bus Namespace gets created.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/04/Configure-the-new-Azure-Service-Bus-Namespace.jpg"><img loading="lazy" src="/assets/img/posts/2021/04/Configure-the-new-Azure-Service-Bus-Namespace.jpg" alt="Configure the new Azure Service Bus Namespace" /></a><p> Configure the new Azure Service Bus Namespace</p></div><p>After the deployment, click on Queue and then add a new Queue.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/04/Create-a-new-Queue.jpg"><img loading="lazy" src="/assets/img/posts/2021/04/Create-a-new-Queue.jpg" alt="Create a new Queue" /></a><p> Create a new Queue</p></div><p>Give the queue a name and leave all settings as they are.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/04/Configure-the-new-Queue.jpg"><img loading="lazy" src="/assets/img/posts/2021/04/Configure-the-new-Queue.jpg" alt="Configure the new Queue" /></a><p> Configure the new Queue</p></div><h3 id="configure-the-access-to-the-queue-using-shared-access-policies-sas">Configure the Access to the Queue using Shared Access Policies (SAS)</h3><p>After the queue is created, click on it and then select the Shared access policies tab. There click on Add, select the Send checkbox and click on Save.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/04/Create-a-SAS-for-the-Queue.jpg"><img loading="lazy" src="/assets/img/posts/2021/04/Create-a-SAS-for-the-Queue.jpg" alt="Create a SAS for the Queue" /></a><p> Create a SAS for the Queue</p></div><p>We will use this SAS to allow the microservice to send messages to the queue. You can also give the manage permission if you want your microservice to be allowed to create queues but I prefer as few permissions as possible. Additionally, I will show in a future post how to create the infrastructure using an Azure DevOps CI/CD pipeline.</p><h2 id="send-messages-to-the-azure-service-bus-queue-from-a-microservice">Send Messages to the Azure Service Bus Queue from a Microservice</h2><p>You can find the code of the demo on <a href="https://github.com/WolfgangOfner/MicroserviceDemo" target="_blank" rel="noopener noreferrer">Github</a>.</p><p>The Azure Service Bus Queue is created and configured and now we can configure the microservice to send messages to the new queue. First, we add the following settings to the appsettings.json file:</p><script src="https://gist.github.com/WolfgangOfner/92945838d4751c6c601c0fd15b2954cf.js"></script><p>These settings container the Azure Service Bus queue name, the connection string, and also a switch to use RabbitMQ or Azure Service Bus Queue. I used the in-memory switch already in a previous post, <a href="/microservice-with-database-kubernetes">Use a Database with a Microservice running in Kubernetes</a>. The queue switch will work the same way and either register the RabbitMQ service or the Azure Service Bus Queue service. In the appsettings.Development.json file, add the UserabbitMq attribute and set it to true.</p><p>Next, create a new class that will contain the Azure Service Bus options:</p><script src="https://gist.github.com/WolfgangOfner/f34227e6753663e041590fcdb8ec497c.js"></script><p>In the ConfigureServices method of the Startup.cs class, read the AzureServiceBus section into the previously created AzureServiceBusConfiguration classs:</p><script src="https://gist.github.com/WolfgangOfner/7006891626f0dcc9dbcdc82475be87e5.js"></script><p>Additionally, read the UserabbitMq variable and either register the already existing RabbitMQ service or th Azure Service Bus service:</p><script src="https://gist.github.com/WolfgangOfner/78a0e1fd77f112a88f4b1c7d949aaed7.js"></script><p>That is all the configuration needed. Lastly, go to the CustomerApi.Messaging.Send project and install the Azure.Messaging.ServiceBus NuGet package and then create a new class called CustomerUpdateSenderServiceBus. This class inherits from the ICustomerUpdateSender interface and takes a customer and sends it to the Azure Service Bus Queue. The full class looks as follows:</p><script src="https://gist.github.com/WolfgangOfner/a1c2f579bd1c4663d5f130cc3f17d52a.js"></script><p>This code is very simple but will throw an exception if the queue does not exist.</p><h2 id="test-the-azure-service-bus-integration-in-the-microservice">Test the Azure Service Bus integration in the Microservice</h2><p>Start the microservice and update a Customer using the Swagger UI.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/04/Update-an-existing-customer.jpg"><img loading="lazy" src="/assets/img/posts/2021/04/Update-an-existing-customer.jpg" alt="Update an existing customer" /></a><p> Update an existing customer</p></div><p>After updating the customer, open the Service Bus Queue in the Azure Portal and select the Service Bus Explorer tab. There, you should see one message in the queue.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/04/One-message-got-sent-to-the-Queue.jpg"><img loading="lazy" src="/assets/img/posts/2021/04/One-message-got-sent-to-the-Queue.jpg" alt="One message got sent to the Queue" /></a><p> One message got sent to the Queue</p></div><p>Select the Peek option (look at the first message without deleting it) and you should see your previously edited customer.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/04/The-updated-customer-got-sent-to-the-Queue.jpg"><img loading="lazy" src="/assets/img/posts/2021/04/The-updated-customer-got-sent-to-the-Queue.jpg" alt="The updated customer got sent to the Queue" /></a><p> The updated customer got sent to the Queue</p></div><h2 id="deploy-the-microservice-to-kubernetes-and-use-the-azure-service-bus">Deploy the Microservice to Kubernetes and use the Azure Service Bus</h2><p>To use the Azure Service Bus Queue in Kubernetes, you have to tell your microservice the connection string. This works the same way as providing a database connection string which I described in <a href="/microservice-with-database-kubernetes">Use a Database with a Microservice running in Kubernetes</a>.</p><p>First, click on Variables and add a new variable inside your Azure DevOps pipeline. Name the variable AzureServiceBusConnectionString and past the connection string from the previously created SAS as the value.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/04/Add-the-Service-Bus-Queue-Connection-String.jpg"><img loading="lazy" src="/assets/img/posts/2021/04/Add-the-Service-Bus-Queue-Connection-String.jpg" alt="Add the Service Bus Queue Connection String" /></a><p> Add the Service Bus Queue Connection String</p></div><p>After adding the variable, add the following code to the values.release.yaml file.</p><script src="https://gist.github.com/WolfgangOfner/e3e9c3c43c06a2480d9a6cd8897cebb5.js"></script><p>This code creates a secret in Kubernetes with the value of the previously created variable. This secret will overwrite the appsettings of the microservice and therefore allow it to access the Azure Service Bus Queue and no sensitive information was exposed in the pipeline.</p><p>This code is using Helm to create the secret and Tokenizer to replace __AzureServiceBusConnectionString__ with the value of the variable AzureServiceBusConnectionString. For more information on these topics see <a href="/deploy-kubernetes-using-helm">Deploy to Kubernetes using Helm Charts</a>, <a href="/override-appsettings-in-kubernetes">Override Appsettings in Kubernetes</a> and <a href="/replace-helm-variables-tokenizer">Replace Helm Chart Variables in your CI/CD Pipeline with Tokenizer</a></p><h2 id="conclusion">Conclusion</h2><p>Cloud providers, especially Azure, offer a wide range of services. This allows developers to use different PaaS solutions which help them to focus on their implementation, rather than running and maintaining the infrastructure. Azure Service Bus is an enterprise queueing solution and can replace RabbitMQ if you want to take advantage of the PaaS offering instead of running RabbitMQ yourself. I added a switch to the microservice, so you can easily switch between RabbitMQ and Azure Service Bus Queue.</p><p>In my next post, I will show you how to replace the background service in the OrderApi with Azure Functions to use a serverless solution to process the messages on the queue.</p><p>You can find the code of the demo on <a href="https://github.com/WolfgangOfner/MicroserviceDemo" target="_blank" rel="noopener noreferrer">Github</a>.</p><p>This post is part of <a href="/microservice-series-from-zero-to-hero">“Microservice Series - From Zero to Hero”</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cloud/'>Cloud</a>, <a href='/categories/devops/'>DevOps</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/devops/" class="post-tag no-text-decoration" >DevOps</a> <a href="/tags/ci-cd/" class="post-tag no-text-decoration" >CI-CD</a> <a href="/tags/azure-devops/" class="post-tag no-text-decoration" >Azure DevOps</a> <a href="/tags/azure/" class="post-tag no-text-decoration" >Azure</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >Kubernetes</a> <a href="/tags/aks/" class="post-tag no-text-decoration" >AKS</a> <a href="/tags/helm/" class="post-tag no-text-decoration" >Helm</a> <a href="/tags/azure-service-bus/" class="post-tag no-text-decoration" >Azure Service Bus</a> <a href="/tags/rabbitmq/" class="post-tag no-text-decoration" >RabbitMq</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Replace RabbitMQ with Azure Service Bus Queues - Programming With Wolfgang&url=https://www.programmingwithwolfgang.com/replace-rabbitmq-azure-service-bus-queue/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Replace RabbitMQ with Azure Service Bus Queues - Programming With Wolfgang&u=https://www.programmingwithwolfgang.com/replace-rabbitmq-azure-service-bus-queue/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Replace RabbitMQ with Azure Service Bus Queues - Programming With Wolfgang&url=https://www.programmingwithwolfgang.com/replace-rabbitmq-azure-service-bus-queue/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.programmingwithwolfgang.com/replace-rabbitmq-azure-service-bus-queue/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/rabbitmq-in-an-asp-net-core-3-1-microservice/">RabbitMQ in an ASP .NET Core 3.1 Microservice</a><li><a href="/microservice-series-from-zero-to-hero/">Microservice Series - From Zero to Hero</a><li><a href="/net-core-3-0-whats-new/">.NET Core 3.0 - What's new</a><li><a href="/microservices-getting-started/">Microservices - Getting Started</a><li><a href="/programming-microservices-net-core-3-1/">Programming a Microservice with .NET Core 3.1</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/aks/">AKS</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/learning/">Learning</a> <a class="post-tag" href="/tags/helm/">Helm</a> <a class="post-tag" href="/tags/yaml/">YAML</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/monitor-net-microservices-with-prometheus/"><div class="card-body"> <span class="timeago small" > Jul 26 <i class="unloaded">2021-07-26T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Monitor .NET Microservices in Kubernetes with Prometheus</h3><div class="text-muted small"><p> Knowledge is power is a famous saying which also holds true when running software. You would like to know how many errors occur, how long the response times of your services are, and also how many ...</p></div></div></a></div><div class="card"> <a href="/create-grafana-dashboards-with-prometheus-metrics/"><div class="card-body"> <span class="timeago small" > Aug 2 <i class="unloaded">2021-08-02T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Create Grafana Dashboards with Prometheus Metrics</h3><div class="text-muted small"><p> In my last post, I added the Prometheus client library to my .NET microservices. This was the first step to implement monitoring of the microservices which are running in a Kubernetes cluster. In ...</p></div></div></a></div><div class="card"> <a href="/microservice-series-from-zero-to-hero/"><div class="card-body"> <span class="timeago small" > Dec 2, 2020 <i class="unloaded">2020-12-02T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Microservice Series - From Zero to Hero</h3><div class="text-muted small"><p> I am working as a consultant and software engineer on different projects which focus on microservice, DevOps, and process automation. Many of my consulting jobs are about explaining microservice, w...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/azure-container-registry-kubernetes/" class="btn btn-outline-primary"><p>Use Azure Container Registry in Kubernetes</p></a> <a href="/azure-functions-process-queue-messages/" class="btn btn-outline-primary"><p>Use Azure Functions to Process Queue Messages</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//programmingwithwolfgang.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://www.programmingwithwolfgang.com/replace-rabbitmq-azure-service-bus-queue/'; this.page.identifier = '/replace-rabbitmq-azure-service-bus-queue/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/wolfgang_ofner">Wolfgang Ofner</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/aks/">AKS</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/learning/">Learning</a> <a class="post-tag" href="/tags/helm/">Helm</a> <a class="post-tag" href="/tags/yaml/">YAML</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.programmingwithwolfgang.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
