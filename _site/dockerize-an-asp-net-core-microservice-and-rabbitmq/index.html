<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Dockerize an ASP .NET Core Microservice and RabbitMQ" /><meta name="author" content="Wolfgang Ofner" /><meta property="og:locale" content="en" /><meta name="description" content="Today I will dockerize my microservices and create a Docker container that can be run anywhere as long as Docker is installed." /><meta property="og:description" content="Today I will dockerize my microservices and create a Docker container that can be run anywhere as long as Docker is installed." /><link rel="canonical" href="/dockerize-an-asp-net-core-microservice-and-rabbitmq/" /><meta property="og:url" content="/dockerize-an-asp-net-core-microservice-and-rabbitmq/" /><meta property="og:site_name" content="Programming With Wolfgang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-04-21T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Dockerize an ASP .NET Core Microservice and RabbitMQ" /><meta name="twitter:site" content="@wolfgang_ofner" /><meta name="twitter:creator" content="@Wolfgang Ofner" /><meta name="google-site-verification" content="xxsPm-h6A0B6a0QMgqXO80PU4DbMt4Dq06p-SGzB3TU" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Wolfgang Ofner"},"dateModified":"2020-04-21T00:00:00+02:00","datePublished":"2020-04-21T00:00:00+02:00","description":"Today I will dockerize my microservices and create a Docker container that can be run anywhere as long as Docker is installed.","headline":"Dockerize an ASP .NET Core Microservice and RabbitMQ","mainEntityOfPage":{"@type":"WebPage","@id":"/dockerize-an-asp-net-core-microservice-and-rabbitmq/"},"url":"/dockerize-an-asp-net-core-microservice-and-rabbitmq/"}</script><title>Dockerize an ASP .NET Core Microservice and RabbitMQ | Programming With Wolfgang</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Programming With Wolfgang"><meta name="application-name" content="Programming With Wolfgang"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> (function (c, l, a, r, i, t, y) { c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) }; t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i; y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y); })(window, document, "clarity", "script", "hc0wl2v6mn"); </script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/author/author-wolfgang-ofner.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Programming With Wolfgang</a></div><div class="site-subtitle font-italic">Let's talk programming</div></div><div class="w-100 d-flex justify-content-center"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span></div><ul class="w-100" style="margin-top: 1em;"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/speaking/" class="nav-link"> <i class="fa-fw fas fa-microphone ml-xl-3 mr-xl-3 unloaded"></i> <span>SPEAKING</span> </a><li class="nav-item"> <a href="/youtube/" class="nav-link"> <i class="fa-fw fas fa-video ml-xl-3 mr-xl-3 unloaded"></i> <span>YOUTUBE</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="w-100" style="margin-top: 1em; text-align: center;"> <img src="/assets/img/author/azure-solutions-architect-expert.png" alt="Azure Solutions Architect Expert" width="200px" height="200px"></div><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <a href="https://github.com/wolfgangofner" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/wolfgang_ofner" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/wolfgangofner" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.youtube.com/channel/UCmiFK5vpvsi6j6gD7W_rsVQ" aria-label="Youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="d-sm-none row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Dockerize an ASP .NET Core Microservice and RabbitMQ</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><div style="visibility:hidden;"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Dockerize an ASP .NET Core Microservice and RabbitMQ</h1><div class="post-meta text-muted d-flex flex-column"><div> <span> Posted <em class="" data-ts="1587420000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 21, 2020 </em> </span> by <span class="author"> By <em> Wolfgang Ofner </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1675 words"> <em>19 min</em></span> read</div></div><div class="post-content"><p><a href="/rabbitmq-in-an-asp-net-core-3-1-microservice/" target="_blank" rel="noopener noreferrer">In my last post</a>, I added RabbitMQ to my two microservices which finished all the functional requirements. Microservices became so popular because they can be easily deployed using Docker. Today I will dockerize my microservices and create a Docker container that can be run anywhere as long as Docker is installed. I will explain most of the Docker commands but basic knowledge about starting and stopping containers is recommended.</p><p>This post is part of <a href="/microservice-series-from-zero-to-hero">“Microservice Series - From Zero to Hero”</a>.</p><h2 id="what-is-docker"><span class="mr-2">What is Docker?</span><a href="#what-is-docker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Docker is the most popular container technology. It is written in Go and open-source. A container can contain a Windows or Linux application and will always be identical bit by bit, no matter where you start it. This means it runs the same way during development, on the testing environment, and on the production environment. This eliminates the famous “It works on my machine”.</p><p>Another big advantage is that Docker containers share the host system kernel. This makes them way smaller than a virtual machine and enables them to start within seconds or even less. For more information about Docker, check out <a href="https://www.docker.com/resources/what-container" target="_blank" rel="noopener noreferrer">Docker.com</a>. There you can also download Docker Desktop which you will need to run a Docker container on your machine.</p><h2 id="what-is-docker-hub"><span class="mr-2">What is Docker Hub?</span><a href="#what-is-docker-hub" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub</a> is like GitHub for Docker containers. You can sign up for free and get unlimited public repos and one private repo. There are also enterprise plans which give you more private repos, build pipelines for your containers, and security scanning.</p><p>To dockerize an application means that you create a Docker container or at least a Dockerfile which describes how to create the container. You can upload the so-called container image to container registries like Docker Hub so other developers can easily download and run them.</p><p>Docker Hub is the go-to place if you want to download official container images. The RabbitMQ from the last post was downloaded from there or you can download Redis, SQL Server from Microsoft, or thousands of other popular applications.</p><h2 id="dockerize-the-microservices"><span class="mr-2">Dockerize the Microservices</span><a href="#dockerize-the-microservices" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You can find the code of  the finished demo on <a href="https://github.com/WolfgangOfner/MicroserviceDemo" target="_blank" rel="noopener noreferrer">GitHub</a>.</p><p>Visual Studio makes it super easy to dockerize your application. All you have to do is to right-click on the API project and then select Add –&gt; Docker Support.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Dockerize-your-application.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Dockerize-your-application.jpg" alt="Dockerize your application" data-proofer-ignore></a><p> Dockerize your application</p></div><p>This opens a new window where you can select Linux or Windows as OS for the container. I am always going for Linux as my default choice because the image is way smaller than Windows ones and therefore starts faster. Also, all my other containers run on Linux and on Docker Desktop, you can only run containers with the same OS at a time. After clicking OK, the Dockerfile and .dockerignore files are added. That’s all you have to do to dockerize the application.</p><h3 id="dockerfile-and-dockerignore-files"><span class="mr-2">Dockerfile and .dockerignore Files</span><a href="#dockerfile-and-dockerignore-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The .dockerignore file is like the .gitignore file and contains extensions and paths which should not be copied into the container. Default extensions in the .dockerignore file are .vs, /bin or /obj. The .dockerignore file is not required to dockerize your application but is highly recommended.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Content-of-the-.dockerignore-file.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Content-of-the-.dockerignore-file.jpg" alt="Content of the .dockerignore file" data-proofer-ignore></a><p> Content of the .dockerignore file</p></div><p>The Dockerfile is a set of instructions to build and run an image. Visual Studio creates a multi-stage Dockerfile which means that it builds the application but only adds necessary files and images to the container image. The Dockerfile uses the .NET Core SDK to build the image but uses the way smaller .NET Core runtime image inside of the container. Let’s take a look at the different stages of the Dockerfile.</p><h3 id="understanding-the-multi-stage-dockerfile"><span class="mr-2">Understanding the multi-stage Dockerfile</span><a href="#understanding-the-multi-stage-dockerfile" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><script src="https://gist.github.com/WolfgangOfner/9496cc3a7c647119d048374545deb839.js"></script><p>The first part downloads the .NET Core 3.1 runtime image from Docker Hub and gives it the name base which will be used later on. Then it sets the working directory to /app which will also be later used. Lastly, the ports 80 and 443 are exposed which tells Docker to listen to these two ports when the container is running.</p><script src="https://gist.github.com/WolfgangOfner/218e844a913736dd20c7941b5dcf70e6.js"></script><p>The next section downloads the .NET Core 3.1 SDK from Docker Hub and names it build. Then the working directory is set to /src and all project files (except the test projects) of the solution are copied inside the container. Then dotnet restore is executed to restore all NuGet packages and the working directory is changed to the directory of the API project. Note that the path starts with /src, the working directory path I set before I copied the files inside the container. Lastly, dotnet build is executed which builds the project with the Release configuration into the path /app/build.</p><script src="https://gist.github.com/WolfgangOfner/f486f3b405c7eac47a285da499ebac01.js"></script><p>The build image in the first line of the next section is the SDK image that we downloaded before and named build. We use it to run dotnet publish which publishes the CustomerApi project.</p><script src="https://gist.github.com/WolfgangOfner/db18786982b7fe7032fd5849961a7088.js"></script><p>The last section uses the runtime image and sets the working directory to /app. Then the published files from the last step are copied into the working directory. The dot means that it is copied to your current location, therefore /app. The Entrypoint command tells Docker that the container contains a .NET application and that it should run the CustomerApi.dll when the container starts.</p><p>For more details on the Dockerfile and .dockerignore file check out the <a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener noreferrer">official documentation</a>.</p><h2 id="test-the-dockerized-application"><span class="mr-2">Test the dockerized Application</span><a href="#test-the-dockerized-application" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After adding the Docker support to your application, you should be able to select Docker as a startup option in Visual Studio. When you select Docker for the first time, Visual Studio will run the Dockerfile, therefore build and create the container. This might take a bit because the images for the .NET Core runtime and SDK need to be downloaded. After the first download, they are cached and can be quickly reused.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Select-Docker-as-startup-option.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Select-Docker-as-startup-option.jpg" alt="Dockerize the application and select Docker as startup option" data-proofer-ignore></a><p> Select Docker as startup option</p></div><p>Click F5 or on the Docker button and your application should start as you are used to. If you don’t believe me that it is running inside a Docker container, you can check the running containers in PowerShell with the command docker ps.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Check-the-running-containers.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Check-the-running-containers.jpg" alt="Check the running containers" data-proofer-ignore></a><p> Check the running containers</p></div><p>The screenshot above shows that the customerapi image was started two minutes ago, that it is running for two minutes, and that it maps the port 32789 to port 80 and 32788 to 433. To stop a running container, you can use docker stop [id]. In my case. this would be docker stop f25727f43d6b. You don’t have to use the full id, like in git. Docker only needs to clearly identify the image you want to stop. So you could use docker stop f25.</p><h2 id="build-the-dockerfile-without-visual-studio"><span class="mr-2">Build the Dockerfile without Visual Studio</span><a href="#build-the-dockerfile-without-visual-studio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You don’t need Visual Studio to create a Docker image. This is useful when you want to create the image and then push it to a container registry like Docker Hub. You should always do this in a build pipeline but it’s useful to know how to do it by hand and sometimes you need it to quickly test something.</p><p>Open Powershell or bash and navigate to the folder containing the CustomerApi.sln file. To build an image, you can use docker build [build context] [location of Dockerfile]. Optionally, you can add a tag by using -t tagname. Use</p><script src="https://gist.github.com/WolfgangOfner/c1bb534d2455c50f33dfbdac4270798c.js"></script><p>to build the Dockerfile which is in your current folder with the tag name customerapi. This will download the needed images (or use them from the cache) and start to build your image.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Build-the-docker-image.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Build-the-docker-image.jpg" alt="Build the docker image" data-proofer-ignore></a><p> Build the docker image</p></div><p>To confirm that your image was really created, use docker images.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Confirm-that-the-image-was-created.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Confirm-that-the-image-was-created.jpg" alt="Confirm that the image was created" data-proofer-ignore></a><p> Confirm that the image was created</p></div><h3 id="start-the-newly-built-image"><span class="mr-2">Start the newly built Image</span><a href="#start-the-newly-built-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To start an image use docker run [-p “port outside of the container”:”port inside the container”] name of the image to start. In my example:</p><script src="https://gist.github.com/WolfgangOfner/eccf91714dcf13760abe7c198b96e7ab.js"></script><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Run-the-previously-created-image.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Run-the-previously-created-image.jpg" alt="Run the previously created image dockerize" data-proofer-ignore></a><p> Run the previously created image</p></div><p>After the container is started, open localhost:32789 and you should see the Swagger UI of the API. If you use the HTTP port, you will get a connection closed error. HTTPS is currently not working because we have to provide a certificate so kestrel can process HTTPS requests. I will explain <a href="/asp-net-core-with-https-in-docker" target="_blank" rel="noopener noreferrer">in my next post</a> how to add a certificate to the container. For now, I will only use the HTTP port.</p><h3 id="push-the-image-to-docker-hub"><span class="mr-2">Push the Image to Docker Hub</span><a href="#push-the-image-to-docker-hub" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We confirmed that the image is running, and now it is time to share it and therefore upload it to Docker Hub. Docker Hub is the default registry in Docker Desktop. Use “docker login” to login into your Docker Hub account.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Log-in-into-Docker-Hub.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Log-in-into-Docker-Hub.jpg" alt="Log in into Docker Hub" data-proofer-ignore></a><p> Log in into Docker Hub</p></div><p>Next, I have to tag the image I want to upload with the name of my Docker Hub account and the name of the repository I want to use. I do this with docker tag Image DockerhubAccount/repository.</p><script src="https://gist.github.com/WolfgangOfner/ea53cca0239ef5c42b779fdde388adc2.js"></script><p>The last step is to push the image to Docker Hub using “docker push tagname”.</p><script src="https://gist.github.com/WolfgangOfner/a6e08633d5a9869d6a739b88aebc8c4d.js"></script><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Push-the-image-to-Docker-Hub.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Push-the-image-to-Docker-Hub.jpg" alt="Push the image to Docker Hub dockerize" data-proofer-ignore></a><p> Push the image to Docker Hub</p></div><p>To confirm that the image was pushed to Docker Hub, I open my repositories and see the newly create customerapi there.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Confirm-that-the-image-was-pushed-to-Docker-Hub.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Confirm-that-the-image-was-pushed-to-Docker-Hub.jpg" alt="Confirm that the image was pushed to Docker Hub dockerize" data-proofer-ignore></a><p> Confirm that the image was pushed to Docker Hub</p></div><h3 id="testing-the-uploaded-image"><span class="mr-2">Testing the uploaded Image</span><a href="#testing-the-uploaded-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To confirm that everything worked fine, I will download the image and run it on any machine. The only requirement is that Docker is installed. When you click on the repository, you can see the command to download the image. In my example, this is docker pull wolfgangofner/customerapi. I will use docker run because this runs the image and if it is not available, automatically pull it too.</p><script src="https://gist.github.com/WolfgangOfner/94220d65eec67d727600356f8178c60f.js"></script><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2020/04/Run-the-previously-uploaded-image.jpg"><img loading="lazy" data-src="/assets/img/posts/2020/04/Run-the-previously-uploaded-image.jpg" alt="Run the previously uploaded image dockerize" data-proofer-ignore></a><p> Run the previously uploaded image</p></div><p>Open localhost:32789 and the Swagger UI will appear.</p><p>For practice purposes, dockerize the OrderApi. The steps are identical to the steps for the CustomerApi.</p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Today, I showed how to dockerize the microservices to create immutable Docker images which I can easily share using Docker Hub and run everywhere the same way. Currently, only the HTTP port of the application works because we haven’t provided an SSL certificate to process HTTPS requests. <a href="/asp-net-core-with-https-in-docker" target="_blank" rel="noopener noreferrer">In my next post</a>, I will create a development certificate and start the image with it.</p><p>You can find the code of  the finished demo on <a href="https://github.com/WolfgangOfner/MicroserviceDemo" target="_blank" rel="noopener noreferrer">GitHub</a>.</p><p>This post is part of <a href="/microservice-series-from-zero-to-hero">“Microservice Series - From Zero to Hero”</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/docker/'>Docker</a>, <a href='/categories/asp-net/'>ASP.NET</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/net-core-3-1/" class="post-tag no-text-decoration" >.NET Core 3.1</a> <a href="/tags/c/" class="post-tag no-text-decoration" >C#</a> <a href="/tags/cqrs/" class="post-tag no-text-decoration" >CQRS</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >Docker</a> <a href="/tags/docker-compose/" class="post-tag no-text-decoration" >Docker-Compose</a> <a href="/tags/mediatr/" class="post-tag no-text-decoration" >MediatR</a> <a href="/tags/microservice/" class="post-tag no-text-decoration" >Microservice</a> <a href="/tags/rabbitmq/" class="post-tag no-text-decoration" >RabbitMQ</a> <a href="/tags/swagger/" class="post-tag no-text-decoration" >Swagger</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Dockerize+an+ASP+.NET+Core+Microservice+and+RabbitMQ+-+Programming+With+Wolfgang&url=%2Fdockerize-an-asp-net-core-microservice-and-rabbitmq%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Dockerize+an+ASP+.NET+Core+Microservice+and+RabbitMQ+-+Programming+With+Wolfgang&u=%2Fdockerize-an-asp-net-core-microservice-and-rabbitmq%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Dockerize+an+ASP+.NET+Core+Microservice+and+RabbitMQ+-+Programming+With+Wolfgang&url=%2Fdockerize-an-asp-net-core-microservice-and-rabbitmq%2F" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=%2Fdockerize-an-asp-net-core-microservice-and-rabbitmq%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/aks/">AKS</a> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/video/">Video</a> <a class="post-tag" href="/tags/youtube/">Youtube</a> <a class="post-tag" href="/tags/conference/">Conference</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/programming-microservices-net-core-3-1/"><div class="card-body"> <em class="small" data-ts="1586728800" data-df="ll" > Apr 13, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Programming a Microservice with .NET Core 3.1</h3><div class="text-muted small"><p> In my last post, I talked about the theory of a microservice. Today it is going to be more practical. I will create two microservices using ASP .NET Core 3.1. Over the next posts., I will extend th...</p></div></div></a></div><div class="card"> <a href="/document-your-microservice-with-swagger/"><div class="card-body"> <em class="small" data-ts="1586901600" data-df="ll" > Apr 15, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Document your Microservice with Swagger</h3><div class="text-muted small"><p> Swagger is an open-source toolset that can be easily integrated into your solution and helps you to document and test your APIs. It is so simple that even non-technical people can use it. In my la...</p></div></div></a></div><div class="card"> <a href="/cqrs-in-asp-net-core-3-1/"><div class="card-body"> <em class="small" data-ts="1586988000" data-df="ll" > Apr 16, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CQRS in ASP .NET Core 3.1</h3><div class="text-muted small"><p> CQRS stands for Command Query Responsibility Segregation and is used to use different models for read and for write operations. In this post, I will explain how I implemented CQRS in my microservic...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/rabbitmq-in-an-asp-net-core-3-1-microservice/" class="btn btn-outline-primary" prompt="Older"><p>RabbitMQ in an ASP .NET Core 3.1 Microservice</p></a> <a href="/asp-net-core-with-https-in-docker/" class="btn btn-outline-primary" prompt="Newer"><p>ASP .NET Core with HTTPS in Docker</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = '/dockerize-an-asp-net-core-microservice-and-rabbitmq/'; this.page.identifier = '/dockerize-an-asp-net-core-microservice-and-rabbitmq/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://programmingwithwolfgang.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/aks/">AKS</a> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/video/">Video</a> <a class="post-tag" href="/tags/youtube/">Youtube</a> <a class="post-tag" href="/tags/conference/">Conference</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-112077092-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-112077092-1'); }); </script>
