<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>View Components in ASP.NET Core MVC | Programming With Wolfgang</title><meta name="generator" content="Jekyll v4.1.0" /><meta property="og:title" content="View Components in ASP.NET Core MVC" /><meta name="author" content="Wolfgang Ofner" /><meta property="og:locale" content="en_US" /><meta name="description" content="View components are a new feature in ASP.NET Core MVC which replaces the child action feature from the previous version. View components are classes which provide action-style logic to support partial views. This means that complex content can be embedded in views with C# code which can be easily maintained and unit tested.  You can find the source code for the following demo on GitHub." /><meta property="og:description" content="View components are a new feature in ASP.NET Core MVC which replaces the child action feature from the previous version. View components are classes which provide action-style logic to support partial views. This means that complex content can be embedded in views with C# code which can be easily maintained and unit tested.  You can find the source code for the following demo on GitHub." /><link rel="canonical" href="https://www.programmingwithwolfgang.com/view-components-in-asp-net-core-mvc/" /><meta property="og:url" content="https://www.programmingwithwolfgang.com/view-components-in-asp-net-core-mvc/" /><meta property="og:site_name" content="Programming With Wolfgang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-05-09T11:41:52+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="View Components in ASP.NET Core MVC" /><meta name="twitter:site" content="@wolfgang_ofner" /><meta name="twitter:creator" content="@Wolfgang Ofner" /><meta name="google-site-verification" content="xxsPm-h6A0B6a0QMgqXO80PU4DbMt4Dq06p-SGzB3TU" /> <script type="application/ld+json"> {"url":"https://www.programmingwithwolfgang.com/view-components-in-asp-net-core-mvc/","@type":"BlogPosting","headline":"View Components in ASP.NET Core MVC","dateModified":"2019-05-09T11:41:52+02:00","datePublished":"2019-05-09T11:41:52+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.programmingwithwolfgang.com/view-components-in-asp-net-core-mvc/"},"author":{"@type":"Person","name":"Wolfgang Ofner"},"description":"View components are a new feature in ASP.NET Core MVC which replaces the child action feature from the previous version. View components are classes which provide action-style logic to support partial views. This means that complex content can be embedded in views with C# code which can be easily maintained and unit tested.  You can find the source code for the following demo on GitHub.","@context":"https://schema.org"}</script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <script src="/assets/js/post.min.js" async></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112077092-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-112077092-1'); </script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/author/wolfgang-small.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Programming With Wolfgang</a></div><div class="site-subtitle font-italic">Let's talk programming</div></div></div><div class="d-flex justify-content-center"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span></div><ul class="nav flex-column mt-3"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/wolfgangofner" target="_blank" > <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/wolfgang_ofner" target="_blank" > <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/wolfgangofner" target="_blank" > <i class="fab fa-linkedin"></i> </a> <a href=" javascript:window.open('mailto:' + ['wolfgang','programmingwithwolfgang.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="d-sm-none row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>View Components in ASP.NET Core MVC</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><div style="visibility:hidden;"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel">Cancel</span></div></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>View Components in ASP.NET Core MVC</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, May 9, 2019, 11:41 AM +0200" > May 9, 2019 <i class="unloaded">2019-05-09T11:41:52+02:00</i> </span> by <span class="author"> Wolfgang Ofner </span></div></div><div class="post-content"><p>View components are a new feature in ASP.NET Core MVC which replaces the child action feature from the previous version. View components are classes which provide action-style logic to support partial views. This means that complex content can be embedded in views with C# code which can be easily maintained and unit tested.  You can find the source code for the following demo on <a href="https://github.com/WolfgangOfner/MVC-View-Components" target="_blank" rel="noopener noreferrer">GitHub</a>.</p><h2 id="understanding-view-components">Understanding View Components</h2><p>Applications commonly need to embed content in views that aren’t related to the main purpose of the application. Common examples include site navigation tools and authentication panels that let the user login without visiting a separate page. The common thread that all these examples have is that the data required to display the embedded content isn’t part of the model data passed from the action to the view.</p><p>Partial views are used to create reusable markup that is required in views, avoiding the need to duplicate the same content in multiple places in the application. Partial views are a useful feature, but they just contain fragments of HTML and Razor, and the data they operate on is received from the parent view. If you need to display different data, then you run into a problem. You could access the data you need directly from the partial view, but this breaks the separation of concerns that underpins the MVC pattern and results in data retrieval and processing logic being placed in a view file.</p><p>Alternatively, you could extend the view models used by the application so that it includes the data you require, but this means you have to change every action method and it is hard to isolate the functionality of action methods for effective testing.</p><p>This is where view components come in. A view component is a C# class that provides a partial view with the data that it needs, independently from the parent view and the action that renders it. In this regard, a view component can be thought of as a specialized action, but one that is used only to provide a partial view with data. It can’t receive HTTP requests, and the content that it provides will always be included in the parent view.</p><h2 id="creating-a-view-component">Creating a View Component</h2><p>View components can be created in three different ways which are:</p><ul><li>defining a Poco view component<li>deriving from the ViewComponent base class<li>using the ViewComponent attribute</ul><h3 id="creating-poco-view-components">Creating Poco View Components</h3><p>A Poco view component is a class that provides view component functionality without relying on any of the MVC APIs. As with Poco controllers, the kind of view component is awkward to work with but can be helpful in understanding how they work. A Poco view component is any class whose name ends with ViewComponent and that defines an Invoke method. VIew component classes can be defined anywhere in an application, but the convention is to group them together in a folder called Components at the root level of the project.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/The-Poco-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/The-Poco-view-component.jpg" alt="The Poco view component" /></a><p> The Poco view component</p></div><p>You can add your view component to a view by calling the invoke method and passing the view component name:</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Calling-the-VIewComponent-from-the-view.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Calling-the-VIewComponent-from-the-view.jpg" alt="Calling the VIewComponent from the view" /></a><p> Calling the VIewComponent from the view</p></div><p>This code adds the number of countries and its total population on top of the customer table.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Testing-the-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Testing-the-view-component.jpg" alt="Testing the view component" /></a><p> Testing the view component</p></div><p>I know that this is a very simple example but I think it demonstrates how view components work very well.</p><p>First, the PocoViewComponent class was able to get access to the data it required without depending on the action handling the HTTP request or its parent view. Second, defining the logic required to obtain and process the country summary in a C# class which is easily readable and can also be unit tested. Third, the application hasn’t been twisted out of shape by trying to include country objects in view models that are focused on Customer objects. In short, a view component is a self-contained chunk of reusable functionality that can be applied throughout the application and can be developed and tested in isolation.</p><p>Note that you have to include the await keyword. Otherwise, you won’t see an error but only a string representation of a Task will be displayed.</p><h3 id="deriving-from-the-viewcomponent-base-class">Deriving from the ViewComponent Base Class</h3><p>Poco view components are limited in functionality unless they take advantage of the MVC API, which is possible but requires a lot more effort than the more common approach, deriving from the ViewComponent class. Deriving from the base class gives you access to context data and makes it easier to generate results. When you create a derived view component, you don’t have to put ViewComponent in the name.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Calling-the-derived-view-component-from-the-view.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Calling-the-derived-view-component-from-the-view.jpg" alt="Calling the derived view component from the view" /></a><p> Calling the derived view component from the view</p></div><h4 id="understanding-view-component-results">Understanding View Component Results</h4><p>The ability to insert simple values into a parent view isn’t especially useful, but fortunately, view components are capable of much more. More complex effects can be achieved by having the Invoke method return an object that implements the IViewComponentResult interface. There are three built-in classes that implement the IViewComponentResult interface:</p><div class="table-responsive"><table class="table table-striped table-bordered table-hover"><tr><td> Name<td> Description<tr><td> ViewViewComponentResult<td> This class is used to specify a Razor view, with optional view model data. Instances of this class are created using the View method.<tr><td> ContentViewComponentResult<td> This class is used to specify a text result that will be safely encoded for inclusion in an HTML document. Instances of this class are<br /> created using the Content method.<tr><td> HtmlContentViewComponentResult<td> This class is used to specify a fragment of HTML that will be included in the HTML document without further encoding. There<br /> is no ViewComponent method to create this type of result</table></div><p>There is special handling for two result types. If a view component returns a string, then it is used to create a ContentViewComponentResult object. If a view component returns an IHtmlContent object, then it is used to create an HtmlContentViewComponentResult object.</p><h4 id="return-a-partial-view">Return a Partial View</h4><p>The most useful response is the awkwardly named ViewViewComponentResult object, which tells Razor to render a partial view and includes the result in the parent view. The ViewComponent base class provides the View method for creating ViewViewComponentResult objects, and there are the following four versions of the method available:</p><div class="table-responsive"><table class="table table-striped table-bordered table-hover"><tr><td> Name<td> Description<tr><td> View()<td> Using this method selects the default view for the view component and does not provide a view model<tr><td> View(model)<td> Using the method selects the default view and uses the specified object as the view model.<tr><td> View(viewName)<td> Using this method selects the specified view and does not provide a view model.<tr><td> View(viewName, model)<td> Using this method selects the specified view and uses the specified object as the view model.</table></div><p>These methods correspond to those provided by the Controller base class and are used in much the same way.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/The-derived-view-component-returning-an-IViewComponentResult-object.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/The-derived-view-component-returning-an-IViewComponentResult-object.jpg" alt="The derived view component returning an IViewComponentResult object" /></a><p> The derived view component returning an IViewComponentResult object</p></div><p>Selecting a partial view in a view component is similar to selecting a view in a controller but without two important differences: Razor looks for views in different locations and uses a different default view name if none is specified. Razor is looking for the partial view in the following locations:</p><ul><li>/Views/Home/Components/Derived/Default.cshtml<li>/Views/Shared/Components/Derived/Default.cshtml<li>/Pages/Shared/Components/Derived/Default.cshtml</ul><p>If no name is specified, then Razor looks for a file called Default.cshtml. Razor looks in two locations for the partial view. The first location takes into account the name of the controller handling the HTTP request, which allows each controller to have its own custom view. The second location is shared between all controllers.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/View-for-the-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/View-for-the-view-component.jpg" alt="View for the view component" /></a><p> View for the view component</p></div><p>Start the application and you will see the table, produced by the view component in green on top of the customer table.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/The-rendered-view-from-the-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/The-rendered-view-from-the-view-component.jpg" alt="The rendered view from the view component" /></a><p> The rendered view from the view component</p></div><h4 id="returning-html-fragments">Returning HTML Fragments</h4><p>The ContentViewComponentResult class is used to include fragments of HTML in the parent view without using a view. Instances of the ContentViewComponentResult class are created using the Content method inherited from the ViewComponent base class, which accepts a string value. In addition to the Content method, the Invoke method can return a string, and MVC will automatically convert to a ContentViewComponent.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/View-component-which-returns-HTML.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/View-component-which-returns-HTML.jpg" alt="View component which returns HTML" /></a><p> View component which returns HTML</p></div><h4 id="getting-context-data">Getting Context Data</h4><p>Details about the current request and the parent view are provided to a view component through properties of the ViewComponentContext class. The following table shows the available properties:</p><div class="table-responsive"><table class="table table-striped table-bordered table-hover"><tr><td> Name<td> Description<tr><td> Arguments<td> This property returns a dictionary of the arguments provided by the view, which can also be received via the Invoke method.<tr><td> HtmlEncoder<td> This property returns an HtmlEncoder object that can be used to safely encode HTML fragments.<tr><td> ViewComponentDescriptor<td> This property returns a ViewComponentDescriptor, which provides a description of the view component.<tr><td> ViewContext<td> This property returns the ViewContext object from the parent view.<tr><td> ViewData<td> This property returns a ViewDataDictionary, which provides access to the view data provided for the view component.</table></div><h4 id="viewcomponent-base-class-properties">ViewComponent base class Properties</h4><p>The ViewComponent base class provides a set of convenience properties that make it easier to access specific context information:</p><div class="table-responsive"><table class="table table-striped table-bordered table-hover"><tr><td> Name<td> Description<tr><td> ViewComponentContext<td> This property returns the ViewComponentContext object.<tr><td> HttpContext<td> This property returns an HttpContext object that describes the current request and the response that is being prepared.<tr><td> Request<td> This property returns an HttpRequest object that describes the current HTTP request.<tr><td> User<td> This property returns an IPrincipal object that describes the current user.<tr><td> RouteData<td> This property returns a RouteData object that describes the routing data for the current request.<tr><td> ViewBag<td> This property returns the dynamic view bag object, which can be used to pass data between the view component and the view.<tr><td> ModelState<td> This property returns a ModelStateDictionary, which provides details of the model binding process.<tr><td> ViewContext<td> This property returns the ViewContext object that was provided to the parent view.<tr><td> ViewData<td> This property returns a ViewDataDictionary, which provides access to the view data provided for the view component.<tr><td> Url<td> This property returns an IUrlHelper object that can be used to generate URLs.</table></div><p>The context data can be used in whatever way it helps the view component to its work, including varying the way that data is selected or rendering different content or views. To demonstrate this feature, I changed my view component to read the route data and if there is a value for id, I return a message.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Reading-RouteData-in-the-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Reading-RouteData-in-the-view-component.jpg" alt="Reading RouteData in the view component" /></a><p> Reading RouteData in the view component</p></div><p>If I call my action with a value for the id parameter, the string is returned instead of the countries and population.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Changing-the-output-of-the-view-component-depending-on-the-route-data.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Changing-the-output-of-the-view-component-depending-on-the-route-data.jpg" alt="Changing the output of the view component, depending on the route data" /></a><p> Changing the output of the view component, depending on the route data</p></div><h4 id="providing-context-from-the-parent-view-using-arguments">Providing Context from the Parent View using Arguments</h4><p>Parent views can provide additional context data as arguments in the Component.Invoke expression. This feature can be used to provide data from the parent view model or to give guidance about the type of content that the view component should produce. I extended my view component to take a bool parameter. If this parameter is true, I return a message, indicating that the parameter was received and processed.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Working-with-the-parameter-in-the-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Working-with-the-parameter-in-the-view-component.jpg" alt="Working with the parameter in the view component" /></a><p> Working with the parameter in the view component</p></div><p>Next, I change the main view to provide a parameter for my view component.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Providing-an-argument-to-the-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Providing-an-argument-to-the-view-component.jpg" alt="Providing an argument to the view component" /></a><p> Providing an argument to the view component</p></div><p>Start the application and you will see that the previously defined string will be returned to the view.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Changing-the-output-of-the-view-component-depending-on-the-provided-parameter.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Changing-the-output-of-the-view-component-depending-on-the-provided-parameter.jpg" alt="Changing the output of the view component, depending on the provided parameter" /></a><p> Changing the output of the view component, depending on the provided parameter</p></div><p> </p><h2 id="unit-testing-view-components">Unit Testing View Components</h2><p>View components can be unit tested like every other C# class. I created a new test project and implemented a simple test to demonstrate how to test the Invoke method.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Unit-testing-the-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Unit-testing-the-view-component.jpg" alt="Unit testing the view component" /></a><p> Unit testing the view component</p></div><h2 id="creating-asynchronous-view-components">Creating Asynchronous View Components</h2><p>All view components so far were executed synchronously. You can create an asynchronous view component by defining an InvokeAsync method that returns a Task. When Razor receives the Task from the InvokeAsync method, it will wait for it to complete and then insert the result into the main view.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Creating-an-async-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Creating-an-async-view-component.jpg" alt="Creating an async view component" /></a><p> Creating an async view component</p></div><h2 id="hybrid-controller--view-component-classes">Hybrid Controller / View Component Classes</h2><p>View components often provide basic functionality to enhance the current view with additional data. If you have to do more complex operations, you can create a class that is a controller and a view component. This allows for related functionality to be grouped together and reduces code duplication.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/The-hybrid-controller-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/The-hybrid-controller-view-component.jpg" alt="The hybrid controller - view component" /></a><p> The hybrid controller &#8211; view component</p></div><p>The ViewComponent attribute is applied to classes that don’t inherit from the ViewCompnent base class and whose name doesn’t end with ViewComponent, meaning that the normal discovery process wouldn’t normally categorize the class as view component. The Name property sets the name by which the class can be referred to when applying the class using the @Component.Invoke expression in the parent view.</p><p>Since hybrid classes don’t inherit from the ViewComponent base class, they don’t have access to the convenience methods for creating IViewComponentResult object, which means that I have to create the ViewViewComponentResult object directly.</p><h3 id="creating-hybrid-view">Creating Hybrid View</h3><p>A hybrid class requires two sets of views: those that are rendered when the class is used as a controller and those that are rendered when the class is used as a view component. First, I add the view for the controller under Views/Country/Create.cshtml</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/The-view-for-the-controller.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/The-view-for-the-controller.jpg" alt="The view for the controller" /></a><p> The view for the controller</p></div><p>Next, I add a the partial view under Views/Shared/Components/HybridComponent/Default.cshml.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Partial-view-for-the-hybrid-controller.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Partial-view-for-the-hybrid-controller.jpg" alt="Partial view for the hybrid controller" /></a><p> Partial view for the hybrid controller</p></div><p>Lastly, I invoke my hybrid controller from the view with the previously applied name.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/Invoking-the-hybrid-controller-view-component.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/Invoking-the-hybrid-controller-view-component.jpg" alt="Invoking the hybrid controller - view component" /></a><p> Invoking the hybrid controller &#8211; view component</p></div><p>This renders the (super ugly) form.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2019/05/The-rendered-view-of-the-hybrid-controller.jpg"><img loading="lazy" src="/assets/img/posts/2019/05/The-rendered-view-of-the-hybrid-controller.jpg" alt="The rendered view of the hybrid controller" /></a><p> The rendered view of the hybrid controller</p></div><h2 id="conclusion">Conclusion</h2><p>Today, I talked about view components and how they can help you extending your views and introducing more functionality and more information for the users. You can call them synchronously or asynchronously and also easily unit test them. Lastly, I showed how hybrid controller / view components can be used to group more complex code together.</p><p>For more details about the configuring ASP.NET Core, I highly recommend the book “<a href="https://www.amazon.com/Pro-ASP-NET-Core-MVC-2/dp/148423149X" target="_blank" rel="noopener noreferrer">Pro ASP.NET Core MVC 2</a>“. You can find the source code for this demo on <a href="https://github.com/WolfgangOfner/MVC-View-Components" target="_blank" rel="noopener noreferrer">GitHub</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/asp.net/'>ASP.NET</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/net-core/" class="post-tag no-text-decoration">NET Core</a> <a href="/tags/asp.net-core-mvc/" class="post-tag no-text-decoration">ASP.NET Core MVC</a> <a href="/tags/c%23/" class="post-tag no-text-decoration">C#</a> <a href="/tags/view-component/" class="post-tag no-text-decoration">View Component</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=View Components in ASP.NET Core MVC - Programming With Wolfgang&url=https://www.programmingwithwolfgang.com/view-components-in-asp-net-core-mvc/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=View Components in ASP.NET Core MVC - Programming With Wolfgang&u=https://www.programmingwithwolfgang.com/view-components-in-asp-net-core-mvc/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=View Components in ASP.NET Core MVC - Programming With Wolfgang&url=https://www.programmingwithwolfgang.com/view-components-in-asp-net-core-mvc/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.programmingwithwolfgang.com/view-components-in-asp-net-core-mvc/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/microservice-series-from-zero-to-hero/">Microservice Series - From Zero to Hero</a><li><a href="/run-the-ci-pipeline-during-pull-request/">Run the CI Pipeline during a Pull Request</a><li><a href="/run-tests-inside-docker-during-ci/">Run Tests inside Docker during CI</a></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/xunit/">xUnit</a> <a class="post-tag" href="/tags/swagger/">Swagger</a> <a class="post-tag" href="/tags/mediatr/">MediatR</a> <a class="post-tag" href="/tags/cqrs/">CQRS</a> <a class="post-tag" href="/tags/scrum/">Scrum</a> <a class="post-tag" href="/tags/rabbitmq/">RabbitMQ</a> <a class="post-tag" href="/tags/docker-compose/">Docker Compose</a> <a class="post-tag" href="/tags/agile/">Agile</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/mvc/">MVC</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/getting-to-know-the-startup-class-of-asp-net-core-mvc/"><div class="card-body"> <span class="timeago small" > Apr 29, 2019 <i class="unloaded">2019-04-29T11:15:53+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Getting to know the Startup Class of ASP.Net Core MVC</h3><div class="text-muted small"><p> Every .NET Core web application has a Program class with a static Main method. The Startup class of .Net core is the new version of the Global.asax file. This class is responsible for starting the...</p></div></div></a></div><div class="card"> <a href="/middleware-in-asp-net-core-mvc/"><div class="card-body"> <span class="timeago small" > May 1, 2019 <i class="unloaded">2019-05-01T11:17:11+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Middleware in ASP.NET Core MVC</h3><div class="text-muted small"><p> Middleware is the term used for the components that are combined to form the request pipeline. This pipeline is arranged like a chain. The request is either returned by the middleware or passed to ...</p></div></div></a></div><div class="card"> <a href="/configure-asp-net-core-mvc/"><div class="card-body"> <span class="timeago small" > May 3, 2019 <i class="unloaded">2019-05-03T11:17:40+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Configure ASP.NET Core MVC</h3><div class="text-muted small"><p> Some configurations like the connection string usually change on every environment your application is running on. Instead of hard-coding this information into your application, ASP.NET Core enable...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/dependency-injection-in-asp-net-core-mvc/" class="btn btn-outline-primary"><p>Dependency Injection in ASP.NET Core MVC</p></a> <a href="/understanding-tag-helpers-in-asp-net-core-mvc/" class="btn btn-outline-primary"><p>Understanding Tag Helpers in ASP.NET Core MVC</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//programmingwithwolfgang.disqus.com/embed.js', disqusConfig: function () { this.page.url = 'https://www.programmingwithwolfgang.com/view-components-in-asp-net-core-mvc/'; this.page.identifier = '/view-components-in-asp-net-core-mvc/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/wolfgang_ofner">Wolfgang Ofner</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/xunit/">xUnit</a> <a class="post-tag" href="/tags/swagger/">Swagger</a> <a class="post-tag" href="/tags/mediatr/">MediatR</a> <a class="post-tag" href="/tags/cqrs/">CQRS</a> <a class="post-tag" href="/tags/scrum/">Scrum</a> <a class="post-tag" href="/tags/rabbitmq/">RabbitMQ</a> <a class="post-tag" href="/tags/docker-compose/">Docker Compose</a> <a class="post-tag" href="/tags/agile/">Agile</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/mvc/">MVC</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.programmingwithwolfgang.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
