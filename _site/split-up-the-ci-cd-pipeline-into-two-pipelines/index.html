<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Split up the CI/CD Pipeline into two Pipelines" /><meta name="author" content="Wolfgang Ofner" /><meta property="og:locale" content="en_US" /><meta name="description" content="Modern DevOps is all about delivering high-quality features in a safe and fast way. Therefore using a separate CI and CD pipeline brings many advantages." /><meta property="og:description" content="Modern DevOps is all about delivering high-quality features in a safe and fast way. Therefore using a separate CI and CD pipeline brings many advantages." /><link rel="canonical" href="https://www.programmingwithwolfgang.com/split-up-the-ci-cd-pipeline-into-two-pipelines/" /><meta property="og:url" content="https://www.programmingwithwolfgang.com/split-up-the-ci-cd-pipeline-into-two-pipelines/" /><meta property="og:site_name" content="Programming With Wolfgang" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-14T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Split up the CI/CD Pipeline into two Pipelines" /><meta name="twitter:site" content="@wolfgang_ofner" /><meta name="twitter:creator" content="@Wolfgang Ofner" /><meta name="google-site-verification" content="xxsPm-h6A0B6a0QMgqXO80PU4DbMt4Dq06p-SGzB3TU" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.programmingwithwolfgang.com/split-up-the-ci-cd-pipeline-into-two-pipelines/"},"author":{"@type":"Person","name":"Wolfgang Ofner"},"url":"https://www.programmingwithwolfgang.com/split-up-the-ci-cd-pipeline-into-two-pipelines/","description":"Modern DevOps is all about delivering high-quality features in a safe and fast way. Therefore using a separate CI and CD pipeline brings many advantages.","@type":"BlogPosting","headline":"Split up the CI/CD Pipeline into two Pipelines","dateModified":"2021-06-14T00:00:00+02:00","datePublished":"2021-06-14T00:00:00+02:00","@context":"https://schema.org"}</script><title>Split up the CI/CD Pipeline into two Pipelines | Programming With Wolfgang</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-112077092-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-112077092-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/author/author-wolfgang-ofner.jpg" alt="author wolfgang ofner" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Programming With Wolfgang</a></div><div class="site-subtitle font-italic">Let's talk programming</div></div><div class="w-100 d-flex justify-content-center"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span></div><ul class="w-100" style="margin-top: 1em;"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/wolfgangofner" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/wolfgang_ofner" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/wolfgangofner" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['wolfgang','programmingwithwolfgang.com'].join('@')" aria-label="email" class="order-6" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-7" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="d-sm-none row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Split up the CI/CD Pipeline into two Pipelines</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Split up the CI/CD Pipeline into two Pipelines</div><div style="visibility:hidden;"> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel">Cancel</span></div></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Split up the CI/CD Pipeline into two Pipelines</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Jun 14, 2021, 12:00 AM +0200" > Jun 14 <i class="unloaded">2021-06-14T00:00:00+02:00</i> </span> by <span class="author"> Wolfgang Ofner </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1560 words">18 min</span></div></div><div class="post-content"><p>Modern DevOps is all about delivering high-quality features in a safe and fast way. So far, I am using a single pipeline for all of my CI/CD. This works fine but also makes it harder to make changes in the future. In software development, we have the Single Responsibility Principle (SRP) which states that a class or method should only do one thing. This makes the code simpler and easier to understand. The same principle can be applied to the CI/CD pipeline.</p><p>This post shows how to split up the existing CI/CD pipeline into a CI and a CD pipeline. The separation will make the pipelines simpler and therefore will promote the ability to make changes quickly in the future.</p><p>This post is part of <a href="/microservice-series-from-zero-to-hero">“Microservice Series - From Zero to Hero”</a>.</p><h2 id="things-to-consider-before-splitting-up-the-cicd-pipeline">Things to consider before splitting up the CI/CD Pipeline</h2><p>You can find the code of the demo on <a href="https://github.com/WolfgangOfner/MicroserviceDemo" target="_blank" rel="noopener noreferrer">Github</a>.</p><p>Splitting up the pipeline into a separate CI and CD pipeline is quite simple and barely needs any changes. If you are new to this series, check out <a href="/improve-azure-devops-pipelines-templates">Improve Azure DevOps YAML Pipelines with Templates</a> first and read about the templates used in the CI/CD pipeline.</p><p>The only thing you have to consider before splitting up the CI/CD pipeline is how the CD pipeline knows that it should run and how it can access files from the CI pipeline.</p><h2 id="edit-the-pipeline-for-continuous-integration">Edit the pipeline for Continuous Integration</h2><p>Continuous Integration or CI means that you want to integrate new features always into the master branch and have the branch in a deployable state. This means that I have to calculate the build version number, build the Docker image, push it to Dockerhub and create the Helm package which will be used in the CD pipeline for the deployment. All this exists already and the only step I have to add is publishing the values.release.yaml file and the Helm package to the ArtifactStagingDirectory. This is a built-in variable of Azure DevOps and allows the CD pipeline to access the Helm package and the config file during the deployment.</p><p>The changes are made in the CreateHelmPackage template. The whole template looks as follows:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre><td class="rouge-code"><pre><span class="na">parameters</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">artifactName</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span> 
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">artifactStagingDirectory</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span> 
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">azureSubscription</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">buildNumber</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">clusterResourceGroup</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">chartPath</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">helmVersion</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span> 
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">kubernetesCluster</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">releaseValuesFile</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span> 
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">sourceFolder</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">default</span><span class="pi">:</span>

<span class="na">steps</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">task</span><span class="pi">:</span> <span class="s">Tokenizer@0</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Run</span><span class="nv"> </span><span class="s">Tokenizer'</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="na">sourceFilesPattern</span><span class="pi">:</span> <span class="s">$</span>

  <span class="pi">-</span> <span class="na">task</span><span class="pi">:</span> <span class="s">CopyFiles@2</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Copy</span><span class="nv"> </span><span class="s">Files</span><span class="nv"> </span><span class="s">to:$/$'</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="na">SourceFolder</span><span class="pi">:</span> <span class="s">$</span>
      <span class="na">Contents</span><span class="pi">:</span> <span class="s">values.release.yaml</span>
      <span class="na">TargetFolder</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$/$'</span>

  <span class="pi">-</span> <span class="na">task</span><span class="pi">:</span> <span class="s">HelmInstaller@0</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Install</span><span class="nv"> </span><span class="s">Helm</span><span class="nv"> </span><span class="s">$'</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="na">helmVersion</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$'</span>
      <span class="na">checkLatestHelmVersion</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">installKubectl</span><span class="pi">:</span> <span class="no">true</span>

  <span class="pi">-</span> <span class="na">task</span><span class="pi">:</span> <span class="s">HelmDeploy@0</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">helm</span><span class="nv"> </span><span class="s">package'</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="na">azureSubscriptionEndpoint</span><span class="pi">:</span> <span class="s">$</span>
      <span class="na">azureResourceGroup</span><span class="pi">:</span> <span class="s">$</span>
      <span class="na">kubernetesCluster</span><span class="pi">:</span> <span class="s">$</span>
      <span class="na">command</span><span class="pi">:</span> <span class="s1">'</span><span class="s">package'</span>
      <span class="na">chartPath</span><span class="pi">:</span> <span class="s">$</span>
      <span class="na">chartVersion</span><span class="pi">:</span> <span class="s">$</span>
      <span class="na">destination</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$/$'</span>
      <span class="na">save</span><span class="pi">:</span> <span class="no">false</span>      

  <span class="pi">-</span> <span class="na">publish</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$/$'</span>
    <span class="na">artifact</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$'</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Publish</span><span class="nv"> </span><span class="s">Artifact:</span><span class="nv"> </span><span class="s">$'</span>
</pre></table></code></div></div><p>Splitting up the CI and CD part also helps to make the pipeline smaller. For example, only around half of the variables are needed for the CI pipeline. The whole CI pipeline looks as follows:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="na">name </span><span class="pi">:</span> <span class="s">CustomerApi-CI</span>
<span class="na">trigger</span><span class="pi">:</span>
  <span class="na">branches</span><span class="pi">:</span>
    <span class="na">include</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">master</span>
  <span class="na">paths</span><span class="pi">:</span>
    <span class="na">include</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">CustomerApi/*</span>

<span class="na">pool</span><span class="pi">:</span>
  <span class="na">vmImage</span><span class="pi">:</span> <span class="s1">'</span><span class="s">ubuntu-latest'</span>

<span class="na">variables</span><span class="pi">:</span>  
  <span class="na">AzureSubscription</span><span class="pi">:</span> <span class="s1">'</span><span class="s">AzureServiceConnection'</span> <span class="c1"># Name of the Service Connection</span>
  <span class="na">ApiName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">customerapi'</span>
  <span class="na">ArtifactName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">CustomerApi'</span>
  <span class="na">ArtifactSourceFolder</span><span class="pi">:</span> <span class="s">$(ArtifactName)/$(ArtifactName)</span>
  <span class="na">BuildId</span><span class="pi">:</span> <span class="s">$(Build.BuildId)</span>
  <span class="na">BuildNumber</span><span class="pi">:</span> <span class="s">$(GitVersion.NuGetVersionV2)</span>
  <span class="na">ClusterResourceGroup</span><span class="pi">:</span> <span class="s">MicroserviceDemo</span>    
  <span class="na">ChartPath</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(ArtifactName)/$(ArtifactName)/charts/$(ApiName)'</span>
  <span class="na">HelmVersion</span><span class="pi">:</span> <span class="s">3.5.0</span>  
  <span class="na">Repository</span><span class="pi">:</span> <span class="s1">'</span><span class="s">wolfgangofner/$(ApiName)'</span> <span class="c1"># '&lt;YourACRName&gt;.azurecr.io/&lt;YourRepositoryName&gt;' # replace with your repository  </span>
  <span class="na">KubernetesCluster</span><span class="pi">:</span> <span class="s1">'</span><span class="s">microservice-aks'</span>
  <span class="na">ReleaseValuesFile</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(ArtifactSourceFolder)/values.release.yaml'</span>    

<span class="na">stages</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">stage</span><span class="pi">:</span> <span class="s">Build</span>  
  <span class="na">jobs</span><span class="pi">:</span>  
  <span class="pi">-</span> <span class="na">job</span><span class="pi">:</span> <span class="s">Build</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s">Build and push Docker image and create Helm package</span>
    <span class="na">steps</span><span class="pi">:</span> 
    <span class="pi">-</span> <span class="na">template</span><span class="pi">:</span> <span class="s">templates/BuildVersioning.yml</span>
    <span class="pi">-</span> <span class="na">template</span><span class="pi">:</span> <span class="s">templates/DockerBuildAndPush.yml</span>
      <span class="na">parameters</span><span class="pi">:</span>
          <span class="na">buildId</span><span class="pi">:</span> <span class="s">$(BuildId)</span>
          <span class="na">patMicroserviceDemoNugetsFeed</span><span class="pi">:</span> <span class="s">$(PatMicroserviceDemoNugetsFeed)</span>
          <span class="na">containerRegistry</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Docker</span><span class="nv"> </span><span class="s">Hub'</span> <span class="c1"># MicroserviceDemoRegistry # replace with your Service Connection name</span>
          <span class="na">repository</span><span class="pi">:</span> <span class="s">$(Repository)</span> 
          <span class="na">tag</span><span class="pi">:</span> <span class="s">$(BuildNumber)</span>
          <span class="na">artifactName</span><span class="pi">:</span> <span class="s">$(ArtifactName)</span>
    <span class="pi">-</span> <span class="na">template</span><span class="pi">:</span> <span class="s">templates/CreateHelmPackage.yml</span>
      <span class="na">parameters</span><span class="pi">:</span>          
          <span class="na">azureSubscription</span><span class="pi">:</span> <span class="s">$(AzureSubscription)</span>
          <span class="na">buildNumber</span><span class="pi">:</span> <span class="s">$(BuildNumber)</span>
          <span class="na">clusterResourceGroup</span><span class="pi">:</span> <span class="s">$(ClusterResourceGroup)</span>          
          <span class="na">chartPath</span><span class="pi">:</span> <span class="s">$(ChartPath)</span>          
          <span class="na">kubernetesCluster</span><span class="pi">:</span> <span class="s">$(KubernetesCluster)</span>        
          <span class="na">releaseValuesFile</span><span class="pi">:</span> <span class="s">$(ReleaseValuesFile)</span>
          <span class="na">artifactStagingDirectory</span><span class="pi">:</span> <span class="s">$(Build.ArtifactStagingDirectory)</span>
          <span class="na">artifactName</span><span class="pi">:</span> <span class="s">$(ArtifactName)</span>
          <span class="na">helmVersion</span><span class="pi">:</span> <span class="s">$(HelmVersion)</span>
          <span class="na">sourceFolder</span><span class="pi">:</span> <span class="s">$(ArtifactSourceFolder)</span>
</pre></table></code></div></div><h2 id="creating-the-continous-deployment-pipeline">Creating the Continous Deployment Pipeline</h2><p>The Continous Deployment (CD) pipeline might look a bit complicated at first, but it is almost the same as it was before. The first step is to create a new file, called CustomerApi-CD in the pipelines folder and then configure a trigger to run the pipeline after the CI pipeline. This can be achieved with the pipelines section at the top of the pipeline.</p><div class="language-yaml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="na">name </span><span class="pi">:</span> <span class="s">CustomerApi-CD</span>
<span class="na">trigger</span><span class="pi">:</span> <span class="s">none</span>
<span class="na">resources</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">container</span><span class="pi">:</span> <span class="s">linuxsqlpackage</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">wolfgangofner/linuxsqlpackage:1.0</span>
  <span class="na">pipelines</span><span class="pi">:</span>
   <span class="pi">-</span> <span class="na">pipeline</span><span class="pi">:</span> <span class="s">CustomerApiBuild</span>
     <span class="na">source</span><span class="pi">:</span> <span class="s">CustomerApi-CI</span>
     <span class="na">trigger</span><span class="pi">:</span>
      <span class="na">branches</span><span class="pi">:</span>
       <span class="na">include</span><span class="pi">:</span>
         <span class="pi">-</span> <span class="s">master</span>         
         <span class="pi">-</span> <span class="s">pull/*</span>
         <span class="pi">-</span> <span class="s">refs/pull/*</span>
</pre></table></code></div></div><p>This code references the CustomerApi-CI which is the name of the CI pipeline and runs when there are changes on the master branch or if a pull request triggered the CI pipeline. Next, change the path to the Helm chart package and the values.release.yaml file. These files were uploaded by the CI pipeline and can be found in the Pipeline.Workspace now. This is a built-in variable of Azure DevOps and allows you to access files uploaded by the CI pipeline. The path to the files looks as follows:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="na">ChartPackage</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(Pipeline.Workspace)/CustomerApiBuild/CustomerApi/customerapi-$(RESOURCES.PIPELINE.CustomerApiBuild.RUNNAME).tgz'</span>  
<span class="na">ReleaseValuesFile</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(Pipeline.Workspace)/CustomerApiBuild/CustomerApi/values.release.yaml'</span>
</pre></table></code></div></div><p>The next step is to download the Helm package and the database. This section stays almost the same, except that you have to download the Helm package from the CI pipeline. This is done with the following code.</p><div class="language-yaml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>  <span class="na">jobs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">deployment</span><span class="pi">:</span> <span class="s">Web_Test</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Deploy</span><span class="nv"> </span><span class="s">CustomerApi</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">customerapi-test</span><span class="nv"> </span><span class="s">environment'</span>
    <span class="na">environment</span><span class="pi">:</span> <span class="s">customerapi-test</span>
    <span class="na">strategy</span><span class="pi">:</span>
      <span class="na">runOnce</span><span class="pi">:</span>
        <span class="na">deploy</span><span class="pi">:</span>
          <span class="na">steps</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">download</span><span class="pi">:</span> <span class="s">CustomerApiBuild</span>
            <span class="na">artifact</span><span class="pi">:</span> <span class="s">$(ArtifactName)</span>
</pre></table></code></div></div><h2 id="the-finished-cd-pipeline">The finished CD Pipeline</h2><p>The finished CD pipeline looks as follows.</p><div class="language-yaml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
</pre><td class="rouge-code"><pre><span class="na">name </span><span class="pi">:</span> <span class="s">CustomerApi-CD</span>
<span class="na">trigger</span><span class="pi">:</span> <span class="s">none</span>
<span class="na">resources</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">container</span><span class="pi">:</span> <span class="s">linuxsqlpackage</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">wolfgangofner/linuxsqlpackage:1.0</span>
  <span class="na">pipelines</span><span class="pi">:</span>
   <span class="pi">-</span> <span class="na">pipeline</span><span class="pi">:</span> <span class="s">CustomerApiBuild</span>
     <span class="na">source</span><span class="pi">:</span> <span class="s">CustomerApi-CI</span>
     <span class="na">trigger</span><span class="pi">:</span>
      <span class="na">branches</span><span class="pi">:</span>
       <span class="na">include</span><span class="pi">:</span>
         <span class="pi">-</span> <span class="s">master</span>         
         <span class="pi">-</span> <span class="s">pull/*</span>
         <span class="pi">-</span> <span class="s">refs/pull/*</span>

<span class="na">pool</span><span class="pi">:</span>
  <span class="na">vmImage</span><span class="pi">:</span> <span class="s1">'</span><span class="s">ubuntu-latest'</span>

<span class="na">variables</span><span class="pi">:</span>  
  <span class="na">AzureSubscription</span><span class="pi">:</span> <span class="s1">'</span><span class="s">AzureServiceConnection'</span> <span class="c1"># Name of the Service Connection</span>
  <span class="na">ApiName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">customerapi'</span>
  <span class="na">ArtifactName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">CustomerApi'</span>      
  <span class="na">ClusterResourceGroup</span><span class="pi">:</span> <span class="s">MicroserviceDemo</span>  
  <span class="na">ChartPackage</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(Pipeline.Workspace)/CustomerApiBuild/CustomerApi/customerapi-$(RESOURCES.PIPELINE.CustomerApiBuild.RUNNAME).tgz'</span>  
  <span class="na">DatabaseName</span><span class="pi">:</span> <span class="s">Customer</span>
  <span class="na">HelmVersion</span><span class="pi">:</span> <span class="s">3.5.0</span>    
  <span class="na">KubernetesCluster</span><span class="pi">:</span> <span class="s1">'</span><span class="s">microservice-aks'</span>
  <span class="na">ReleaseValuesFile</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(Pipeline.Workspace)/CustomerApiBuild/CustomerApi/values.release.yaml'</span>
  <span class="na">SQLServerName</span><span class="pi">:</span> <span class="s">wolfgangmicroservicedemosql.database.windows.net</span> <span class="c1"># replace with your server url  </span>
  <span class="na">IngressEnabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">TlsSecretName</span><span class="pi">:</span> <span class="s">customerapi-tls</span>  

<span class="na">stages</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">stage</span><span class="pi">:</span> <span class="s">Test</span>  
  <span class="na">condition</span><span class="pi">:</span> <span class="s">ne(variables['Build.Reason'], 'PullRequest')</span>
  <span class="na">variables</span><span class="pi">:</span>
    <span class="na">K8sNamespace</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(ApiName)-$(DeploymentEnvironment)'</span>
    <span class="na">ConnectionString</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Server=tcp:$(SQLServerName),1433;Initial</span><span class="nv"> </span><span class="s">Catalog=$(DatabaseName);Persist</span><span class="nv"> </span><span class="s">Security</span><span class="nv"> </span><span class="s">Info=False;User</span><span class="nv"> </span><span class="s">ID=$(DbUser);Password=$(DbPassword);MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection</span><span class="nv"> </span><span class="s">Timeout=30;"</span>
    <span class="na">URL</span><span class="pi">:</span> <span class="s">customer.programmingwithwolfgang.com</span> <span class="c1"># replace with your service url</span>
  <span class="na">jobs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">deployment</span><span class="pi">:</span> <span class="s">Web_Test</span>
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Deploy</span><span class="nv"> </span><span class="s">CustomerApi</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">customerapi-test</span><span class="nv"> </span><span class="s">environment'</span>
    <span class="na">environment</span><span class="pi">:</span> <span class="s">customerapi-test</span>
    <span class="na">strategy</span><span class="pi">:</span>
      <span class="na">runOnce</span><span class="pi">:</span>
        <span class="na">deploy</span><span class="pi">:</span>
          <span class="na">steps</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">download</span><span class="pi">:</span> <span class="s">CustomerApiBuild</span>
            <span class="na">artifact</span><span class="pi">:</span> <span class="s">$(ArtifactName)</span>
          <span class="pi">-</span> <span class="na">template</span><span class="pi">:</span> <span class="s">templates/DeployHelmPackage.yml</span>
            <span class="na">parameters</span><span class="pi">:</span>
              <span class="na">apiName</span><span class="pi">:</span> <span class="s">$(ApiName)</span>
              <span class="na">azureSubscription</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(AzureSubscription)'</span>
              <span class="na">clusterResourceGroup</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(ClusterResourceGroup)'</span>
              <span class="na">chartPackage</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(ChartPackage)'</span>              
              <span class="na">helmVersion</span><span class="pi">:</span> <span class="s">$(HelmVersion)</span>
              <span class="na">k8sNamespace</span><span class="pi">:</span> <span class="s">$(K8sNamespace)</span>
              <span class="na">kubernetesCluster</span><span class="pi">:</span> <span class="s">$(KubernetesCluster)</span>
              <span class="na">releaseValuesFile</span><span class="pi">:</span> <span class="s1">'</span><span class="s">$(ReleaseValuesFile)'</span> 
 
  <span class="pi">-</span> <span class="na">deployment</span><span class="pi">:</span> <span class="s">Database_Test</span>
    <span class="na">dependsOn</span><span class="pi">:</span> <span class="s">Web_Test</span>    
    <span class="na">displayName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Deploy</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">database'</span>   
    <span class="na">environment</span><span class="pi">:</span> <span class="s">database-test</span>
    <span class="na">container</span><span class="pi">:</span> <span class="s">linuxsqlpackage</span>
    <span class="na">strategy</span><span class="pi">:</span>
      <span class="na">runOnce</span><span class="pi">:</span>
        <span class="na">deploy</span><span class="pi">:</span>
          <span class="na">steps</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">download</span><span class="pi">:</span> <span class="s">CustomerApiBuild</span>
            <span class="na">artifact</span><span class="pi">:</span> <span class="s">dacpacs</span>
          <span class="pi">-</span> <span class="na">template</span><span class="pi">:</span> <span class="s">templates/DatabaseDeploy.yml</span>
            <span class="na">parameters</span><span class="pi">:</span>          
                <span class="na">connectionString</span><span class="pi">:</span> <span class="s">$(ConnectionString)</span>
                <span class="na">dacpacPath</span><span class="pi">:</span> <span class="s2">"</span><span class="s">$(Pipeline.Workspace)/CustomerApiBuild/dacpacs/$(ArtifactName).Database.Build.dacpac"</span>
</pre></table></code></div></div><h2 id="test-the-new-ci-and-cd-pipelines">Test the new CI and CD Pipelines</h2><p>Before you can use the new CD pipeline, add it to your Azure DevOps pipelines. To do that, open the Pipelines in your Azure DevOps project, click New pipeline and then select the location where your code is stored. On the next page, select Existing Azure Pipelines YAML file and then select the path to the new CD pipeline from the drop-down menu.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/06/Add-the-new-CD-Pipeline-to-Azure-DevOps.jpg"><img loading="lazy" src="/assets/img/posts/2021/06/Add-the-new-CD-Pipeline-to-Azure-DevOps.jpg" alt="Add the new CD Pipeline to Azure DevOps" /></a><p> Add the new CD Pipeline to Azure DevOps</p></div><p>Run the CI pipeline and after the build is finished, the CD pipeline will kick off and deploy the application. After the deployment is finished, open enter your URL (configured in the URL variable in the CD pipeline) in your browser and you should see the Swagger UI of the microservice.</p><div class="col-12 col-sm-10 aligncenter"> <a href="/assets/img/posts/2021/06/The-Microservice-is-running.jpg"><img loading="lazy" src="/assets/img/posts/2021/06/The-Microservice-is-running.jpg" alt="The Microservice is running" /></a><p> The Microservice is running</p></div><p>To access the microservice using the URL, you have to configure the DNS accordingly. See <a href="/configure-custom-urls-to-access-microservices-running-in-kubernetes">Configure custom URLs to access Microservices running in Kubernetes</a> to learn how to do that using an Nginx ingress controller.</p><h2 id="conclusion">Conclusion</h2><p>Using two pipelines, one for CI, one for CD can be achieved quite easily and helps you to keep the complexity inside the pipelines at a minimum. This allows you to add new features, for example, new environments fast and with a smaller chance of making any mistakes. In my next post, I will use the newly created CD pipeline and add a production stage with its own URL and database deployment.</p><p>You can find the code of the demo on <a href="https://github.com/WolfgangOfner/MicroserviceDemo" target="_blank" rel="noopener noreferrer">Github</a>.</p><p>This post is part of <a href="/microservice-series-from-zero-to-hero">“Microservice Series - From Zero to Hero”</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/kubernetes/'>Kubernetes</a>, <a href='/categories/cloud/'>Cloud</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/devops/" class="post-tag no-text-decoration" >DevOps</a> <a href="/tags/azure-devops/" class="post-tag no-text-decoration" >Azure DevOps</a> <a href="/tags/azure/" class="post-tag no-text-decoration" >Azure</a> <a href="/tags/nginx/" class="post-tag no-text-decoration" >Nginx</a> <a href="/tags/yaml/" class="post-tag no-text-decoration" >YAML</a> <a href="/tags/ci-cd/" class="post-tag no-text-decoration" >CI-CD</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >Docker</a> <a href="/tags/helm/" class="post-tag no-text-decoration" >Helm</a> <a href="/tags/aks/" class="post-tag no-text-decoration" >AKS</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >Kubernetes</a> <a href="/tags/tls/" class="post-tag no-text-decoration" >TLS</a> <a href="/tags/ssl/" class="post-tag no-text-decoration" >SSL</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Split up the CI/CD Pipeline into two Pipelines - Programming With Wolfgang&url=https://www.programmingwithwolfgang.com/split-up-the-ci-cd-pipeline-into-two-pipelines/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Split up the CI/CD Pipeline into two Pipelines - Programming With Wolfgang&u=https://www.programmingwithwolfgang.com/split-up-the-ci-cd-pipeline-into-two-pipelines/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Split up the CI/CD Pipeline into two Pipelines - Programming With Wolfgang&url=https://www.programmingwithwolfgang.com/split-up-the-ci-cd-pipeline-into-two-pipelines/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.programmingwithwolfgang.com/split-up-the-ci-cd-pipeline-into-two-pipelines/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/setup-nginx-ingress-controller-kubernetes/">Set up Nginx as Ingress Controller in Kubernetes</a><li><a href="/microservice-series-from-zero-to-hero/">Microservice Series - From Zero to Hero</a><li><a href="/configure-custom-urls-to-access-microservices-running-in-kubernetes/">Configure custom URLs to access Microservices running in Kubernetes</a><li><a href="/how-to-pass-az-303-and-az-304-certification-exams/">How to pass the AZ-303 and AZ-304 Certification Exams</a><li><a href="/develop-azure-app-service-mobile-app/">Develop Azure App Service Mobile App</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/learning/">Learning</a> <a class="post-tag" href="/tags/certification/">Certification</a> <a class="post-tag" href="/tags/exam/">Exam</a> <a class="post-tag" href="/tags/70-532/">70-532</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/aks/">AKS</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/azure-container-registry-kubernetes/"><div class="card-body"> <span class="timeago small" > Apr 12 <i class="unloaded">2021-04-12T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Use Azure Container Registry in Kubernetes</h3><div class="text-muted small"><p> Dockerhub is like GitHub for Docker containers. You can sign up for free and get unlimited public repos and one private repo. This is great for developers like me who want to make their containers ...</p></div></div></a></div><div class="card"> <a href="/replace-rabbitmq-azure-service-bus-queue/"><div class="card-body"> <span class="timeago small" > Apr 19 <i class="unloaded">2021-04-19T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Replace RabbitMQ with Azure Service Bus Queues</h3><div class="text-muted small"><p> RabbitMQ is a great tool to connect microservices asynchronously but it also comes with a couple of downsides. The biggest downside is that you have to take care of running, monitoring, and updatin...</p></div></div></a></div><div class="card"> <a href="/microservice-with-database-kubernetes/"><div class="card-body"> <span class="timeago small" > Mar 29 <i class="unloaded">2021-03-29T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Use a Database with a Microservice running in Kubernetes</h3><div class="text-muted small"><p> I showed in my last post how to automatically deploy database changes to your database. In this post, I will extend my microservice to use this database and also extend the deployment to provide a ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/automatically-issue-ssl-certificates-and-use-ssl-termination-in-kubernetes/" class="btn btn-outline-primary"><p>Automatically issue SSL Certificates and use SSL Termination in Kubernetes</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//programmingwithwolfgang.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://www.programmingwithwolfgang.com/split-up-the-ci-cd-pipeline-into-two-pipelines/'; this.page.identifier = '/split-up-the-ci-cd-pipeline-into-two-pipelines/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/wolfgang_ofner">Wolfgang Ofner</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/azure-devops/">Azure DevOps</a> <a class="post-tag" href="/tags/docker/">Docker</a> <a class="post-tag" href="/tags/learning/">Learning</a> <a class="post-tag" href="/tags/certification/">Certification</a> <a class="post-tag" href="/tags/exam/">Exam</a> <a class="post-tag" href="/tags/70-532/">70 532</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/aks/">AKS</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://www.programmingwithwolfgang.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
